
  
  
 
  
  
 


<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Los Modelos &mdash; SEDD - Manual De Usuario  documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="SEDD - Manual De Usuario  documentation" href="../../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>
<link rel="stylesheet" href="../../_static/style.css">
<div id="cabecera">
  <a href="http://www.unl.edu.ec/"><img src="../../_static/unl.gif" id="logo" border="0" alt="unl" width="90" hight="110"/></a>
</div>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">SEDD - Manual De Usuario</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="../../index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Indice General<b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. Introducción</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">En esta Página<b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Los Modelos</a><ul>
<li><a class="reference internal" href="#introduccion">Introducción</a></li>
<li><a class="reference internal" href="#importaciones-necesarias">Importaciones Necesarias</a></li>
<li><a class="reference internal" href="#clase-configuracion">Clase Configuracion</a></li>
<li><a class="reference internal" href="#clase-ofertaacademicasga">Clase OfertaAcademicaSGA</a></li>
<li><a class="reference internal" href="#clase-periodoacademico">Clase PeriodoAcademico</a></li>
<li><a class="reference internal" href="#clase-asignatura">Clase Asignatura</a></li>
<li><a class="reference internal" href="#clase-estudianteperiodoacademico">Clase EstudiantePeriodoAcademico</a></li>
<li><a class="reference internal" href="#clase-estudianteasignaturadocente">Clase EstudianteAsignaturaDocente</a></li>
<li><a class="reference internal" href="#clase-asignaturadocente">Clase AsignaturaDocente</a></li>
<li><a class="reference internal" href="#clase-docenteperiodoacademico">Clase DocentePeriodoAcademico</a></li>
<li><a class="reference internal" href="#clase-direccioncarrera">Clase DireccionCarrera</a></li>
<li><a class="reference internal" href="#clase-tipoinformante">Clase TipoInformante</a></li>
<li><a class="reference internal" href="#clase-cuestionario">Clase Cuestionario</a></li>
<li><a class="reference internal" href="#clase-contestacion">Clase Contestacion</a></li>
<li><a class="reference internal" href="#clase-evaluacion">Clase Evaluacion</a></li>
<li><a class="reference internal" href="#clase-resultados">Clase Resultados</a></li>
<li><a class="reference internal" href="#clase-tipopregunta">Clase TipoPregunta</a></li>
<li><a class="reference internal" href="#clase-seleccionunica">Clase SeleccionUnica</a></li>
<li><a class="reference internal" href="#clase-seccion">Clase Seccion</a></li>
<li><a class="reference internal" href="#clase-pregunta">Clase Pregunta</a></li>
<li><a class="reference internal" href="#clase-itempregunta">Clase ItemPregunta</a></li>
<li><a class="reference internal" href="#clase-areasga">Clase AreaSGA</a></li>
<li><a class="reference internal" href="#clase-periodoevaluacion">Clase PeriodoEvaluacion</a></li>
<li><a class="reference internal" href="#clase-tabulacion">Clase Tabulacion</a></li>
<li><a class="reference internal" href="#clase-tabulacionevaluacion2013">Clase TabulacionEvaluacion2013</a></li>
<li><a class="reference internal" href="#clase-tabulacionadicionales2012">Clase TabulacionAdicionales2012</a></li>
<li><a class="reference internal" href="#clase-tabulacionsatisfaccion2012">Clase TabulacionSatisfaccion2012</a></li>
<li><a class="reference internal" href="#clase-usuario">Clase Usuario</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li>
  <a href="../../_sources/library/Models/models.txt"
     rel="nofollow">Ver código</a></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Buscar" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="los-modelos">
<span id="models-title"></span><h1>Los Modelos<a class="headerlink" href="#los-modelos" title="Permalink to this headline">¶</a></h1>
<div class="align-center figure" id="models-img-uml">
<img alt="Diagrama UML del Sistema" src="library\Models\../../_static/modeluml.png" />
<p class="caption"><strong>Fig 1.  Diagrama UML del Sistema</strong></p>
</div>
<div class="section" id="introduccion">
<span id="models-intro"></span><h2>Introducción<a class="headerlink" href="#introduccion" title="Permalink to this headline">¶</a></h2>
<p>Un modelo de datos es una descripción de los datos de una base de datos. Es una representación de la estructura de la base de datos con sus distintos componentes(tablas, campos, relaciones) mediante el uso de clases, en este caso escritas en Python.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Para mas información revisar <a class="reference external" href="http://www.cristalab.com/tutoriales/python-en-la-web-con-django-v-modelo-de-datos-c104034l/">Modelos de datos en Django</a>.</p>
</div>
</div>
<div class="section" id="importaciones-necesarias">
<span id="models-imports"></span><h2>Importaciones Necesarias<a class="headerlink" href="#importaciones-necesarias" title="Permalink to this headline">¶</a></h2>
<p>Importando el modulo principal para el diseño de los modelos:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
</pre></div>
</div>
<p>Para realizar la conexión y consultas avanzadas y demás modulos necesarios:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">connection</span>
<span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">Q</span>
<span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">Count</span>
<span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">exceptions</span>
</pre></div>
</div>
<p>Se utiliza el modelo por defecto que nos brinda Django para la administración de usuarios:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
</pre></div>
</div>
<p>Otros moulos usados para trabajar con fechas, xml, diccionarios y logs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">ordereddict</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">lxml.html</span>
<span class="kn">import</span> <span class="nn">logging</span>
</pre></div>
</div>
<p>Se importa la clase <tt class="docutils literal"><span class="pre">SGA</span></tt> que obtiene toda la información academica necesaria para diversos sistemas clientes del SGA:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">proyecto.tools.sgaws.cliente</span> <span class="kn">import</span> <span class="n">SGA</span>
</pre></div>
</div>
<p>El modulo de configuración general:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">proyecto</span> <span class="kn">import</span> <span class="n">settings</span>
</pre></div>
</div>
<p>Asignando el logger a una variable <tt class="docutils literal"><span class="pre">logg</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">logg</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;logapp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-configuracion">
<span id="class-configuracion"></span><h2>Clase Configuracion<a class="headerlink" href="#clase-configuracion" title="Permalink to this headline">¶</a></h2>
<p>La clase <tt class="docutils literal"><span class="pre">Configuración</span></tt> permite realizar una relación <strong>Uno a Uno</strong> entre la <a class="reference internal" href="#class-periodoacademico"><em>Clase PeriodoAcademico</em></a>  y la <a class="reference internal" href="#class-periodoevaluacion"><em>Clase PeriodoEvaluacion</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Configuracion</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">periodoAcademicoActual</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span>
                    <span class="s">&#39;PeriodoAcademico&#39;</span><span class="p">,</span>
                     <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                     <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                     <span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;Periodo Académico Actual&#39;</span>
                     <span class="p">)</span>
    <span class="n">periodoEvaluacionActual</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span>
                    <span class="s">&#39;PeriodoEvaluacion&#39;</span><span class="p">,</span>
                    <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                     <span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;Periodo Evaluación Actual&#39;</span>
                     <span class="p">)</span>
</pre></div>
</div>
<p>Se obtiene el periodo académico actual:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">getPeriodoAcademicoActual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Configuracion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">periodoAcademicoActual</span>
</pre></div>
</div>
<p>Lo mismo que el anterior pero con el periodo de evaluación:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">getPeriodoEvaluacionActual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Configuracion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">periodoEvaluacionActual</span>
</pre></div>
</div>
<p>El nombre que presentará del modelo:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Configuraciones&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Configuraciones&#39;</span>
</pre></div>
</div>
<p>Indica la representación textual (en Unicode) que deseamos que tengan las instancias de este modelo:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">u&quot;Configuraciones de la Aplicación&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-ofertaacademicasga">
<span id="class-ofertaacademicasga"></span><h2>Clase OfertaAcademicaSGA<a class="headerlink" href="#clase-ofertaacademicasga" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">OfertaAcademicaSGA</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">idSGA</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;Id_SGA&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;id_sga&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;100&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;Descripción&#39;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Oferta Académica&#39;</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Ofertas Académicas&#39;</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">descripcion</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-periodoacademico">
<span id="class-periodoacademico"></span><h2>Clase PeriodoAcademico<a class="headerlink" href="#clase-periodoacademico" title="Permalink to this headline">¶</a></h2>
<p>Su finalidad es definir el periodo académico en el cual se realizará la encuesta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PeriodoAcademico</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">nombre</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;50&#39;</span><span class="p">)</span>
    <span class="n">inicio</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">fin</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">periodoLectivo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">db_column</span><span class="o">=</span><span class="s">&#39;periodo_lectivo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Relacion muchos a muchos con la <em class="xref std std-ref">OfertaAcademicaSGA</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ofertasAcademicasSGA</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="s">&#39;OfertaAcademicaSGA&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;peridosAcademicos&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;Ofertas SGA&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Se cargan las ofertas presentes en el <strong>SGA</strong> usando en usuario y contraseña del sistema, existe una excepción de que se agregan solo en el caso que no existan aún la oferta académica:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">cargarOfertasSGA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">proxy</span> <span class="o">=</span> <span class="n">SGA</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">SGAWS_USER</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">SGAWS_PASS</span><span class="p">)</span>
    <span class="n">ofertas_dict</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">ofertas_academicas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inicio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fin</span><span class="p">)</span>
    <span class="n">ofertas</span> <span class="o">=</span> <span class="p">[</span><span class="n">OfertaAcademicaSGA</span><span class="p">(</span><span class="n">idSGA</span><span class="o">=</span><span class="n">oa</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">],</span> <span class="n">descripcion</span><span class="o">=</span><span class="n">oa</span><span class="p">[</span><span class="s">&#39;descripcion&#39;</span><span class="p">])</span>  <span class="k">for</span> <span class="n">oa</span> <span class="ow">in</span> <span class="n">ofertas_dict</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">oa</span> <span class="ow">in</span> <span class="n">ofertas</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">OfertaAcademicaSGA</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">idSGA</span><span class="o">=</span><span class="n">oa</span><span class="o">.</span><span class="n">idSGA</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">OfertaAcademicaSGA</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="n">oa</span><span class="o">.</span><span class="n">periodoAcademico</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">oa</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>Cada vez que se crea un nuevo Periodo Académico se consultan las ofertas academicas del SGA para adherirlas. Luego se pueden eliminar desde la aplicación de administración:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">nuevo</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
        <span class="n">nuevo</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">PeriodoAcademico</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nuevo</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cargarOfertasSGA</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">logg</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Error al cargar ofertas academicas del SGA: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;inicio&#39;</span><span class="p">]</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Periodo Académico&#39;</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Periodos Académicos&#39;</span>
</pre></div>
</div>
<p>El rango de fechas que abarca dicho periodo:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">rango</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;{0} / {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inicio</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%b %Y&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fin</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%b %Y&#39;</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-asignatura">
<span id="class-asignatura"></span><h2>Clase Asignatura<a class="headerlink" href="#clase-asignatura" title="Permalink to this headline">¶</a></h2>
<p>Como su nombre lo indica, en esta clase se administran las distintas asignaturas:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Asignatura</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;20&#39;</span><span class="p">)</span>
    <span class="n">carrera</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;100&#39;</span><span class="p">)</span>
    <span class="n">semestre</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;10&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;módulo&#39;</span><span class="p">)</span>
    <span class="n">paralelo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;50&#39;</span><span class="p">)</span>
    <span class="n">seccion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;10&#39;</span><span class="p">)</span>
    <span class="n">modalidad</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;20&#39;</span><span class="p">)</span>
    <span class="n">nombre</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;15&#39;</span><span class="p">)</span>
    <span class="n">creditos</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;número de créditos&#39;</span><span class="p">)</span>
    <span class="n">duracion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;duración en horas&#39;</span><span class="p">)</span>
    <span class="n">inicio</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;inicia&#39;</span><span class="p">)</span>
    <span class="n">fin</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;termina&#39;</span><span class="p">)</span>
    <span class="c"># Campo combinado id_unidad:id_paralelo</span>
    <span class="n">idSGA</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;15&#39;</span><span class="p">,</span> <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;id_sga&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Clave foránea hacia la <a class="reference internal" href="#class-periodoacademico"><em>Clase PeriodoAcademico</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">periodoAcademico</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;PeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;asignaturas&#39;</span><span class="p">,</span>
                                     <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Periodo Académico&#39;</span><span class="p">,</span> <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;periodo_academico_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Determina si esta vigente es decir si la asignatura se dicta dentro del Periodo de Evaluación Actual:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">esVigente</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">periodoEvaluacion</span> <span class="o">=</span> <span class="n">Configuracion</span><span class="o">.</span><span class="n">getPeriodoEvaluacionActual</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inicio</span> <span class="o">&lt;=</span> <span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">fin</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">fin</span> <span class="o">&gt;=</span> <span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">inicio</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
</pre></div>
</div>
<p>El tipo de dominio pertenece la asignatura:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">getTipo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tipos</span> <span class="o">=</span> <span class="p">[</span><span class="s">u&#39;taller&#39;</span><span class="p">,</span><span class="s">u&#39;curso&#39;</span><span class="p">,</span><span class="s">u&#39;módulo&#39;</span><span class="p">,</span><span class="s">u&#39;modulo&#39;</span><span class="p">,</span><span class="s">u&#39;unidad&#39;</span><span class="p">]</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tipos</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="k">if</span> <span class="n">l</span> <span class="k">else</span> <span class="s">u&#39;otro&#39;</span>
</pre></div>
</div>
<p>Para guardar la información:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tipo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTipo</span><span class="p">()</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Asignatura</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">u&quot;{0} - {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idSGA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-estudianteperiodoacademico">
<span id="class-estudianteperiodoacademico"></span><h2>Clase EstudiantePeriodoAcademico<a class="headerlink" href="#clase-estudianteperiodoacademico" title="Permalink to this headline">¶</a></h2>
<p>Esta clase básicamente permite realizar una relación entre los distintos estudiantes y sus respectivos periodos académicos en los que se encuentran al momento de realizar la encuesta. Para esto primeramente crearemos un enlace hacia la <a class="reference internal" href="#class-usuario"><em>Clase Usuario</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">EstudiantePeriodoAcademico</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">usuario</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;Usuario&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;estudiantePeriodosAcademicos&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Clave foránea de la <a class="reference internal" href="#class-periodoacademico"><em>Clase PeriodoAcademico</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">periodoAcademico</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;PeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;estudiantes&#39;</span><span class="p">,</span>
                                     <span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;Periodo Académico&#39;</span><span class="p">,</span> <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;periodo_academico_id&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">&#39;Estudiante&#39;</span>
    <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;usuario&#39;</span><span class="p">,</span> <span class="s">&#39;periodoAcademico&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Para recuperar la cédula de los estudiantes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">cedula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">usuario</span><span class="o">.</span><span class="n">cedula</span>
</pre></div>
</div>
<p>Este método permite recuperrar las distintas asignaturas que recibe cada estudiante con el docente que las imparte y luego se contruye una lista de diccionarios con la información obtenida:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">paralelos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">consulta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignaturasDocentesEstudiante</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;asignaturaDocente__asignatura__area&#39;</span><span class="p">,</span>
                                                              <span class="s">&#39;asignaturaDocente__asignatura__carrera&#39;</span><span class="p">,</span>
                                                              <span class="s">&#39;asignaturaDocente__asignatura__semestre&#39;</span><span class="p">,</span>
                                                              <span class="s">&#39;asignaturaDocente__asignatura__paralelo&#39;</span><span class="p">,</span>
                                                              <span class="s">&#39;asignaturaDocente__asignatura__seccion&#39;</span><span class="p">,)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
    <span class="n">datos</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="s">&#39;area&#39;</span><span class="p">,</span><span class="s">&#39;carrera&#39;</span><span class="p">,</span><span class="s">&#39;modulo&#39;</span><span class="p">,</span><span class="s">&#39;paralelo&#39;</span><span class="p">,</span><span class="s">&#39;seccion&#39;</span><span class="p">),</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">consulta</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">datos</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">usuario</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-estudianteasignaturadocente">
<span id="class-estudianteasignaturadocente"></span><h2>Clase EstudianteAsignaturaDocente<a class="headerlink" href="#clase-estudianteasignaturadocente" title="Permalink to this headline">¶</a></h2>
<p>Permite realizar una relación entre estudiantes y las asignaturas de los mismos. Para empezar tenemos dos claves foráneas hacia la <a class="reference internal" href="#class-estudianteperiodoacademico"><em>Clase EstudiantePeriodoAcademico</em></a> y la <a class="reference internal" href="#class-asignaturadocente"><em>Clase AsignaturaDocente</em></a> con el fin de obtener una relación general entre estudiantes, materias y docentes que las imparten:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">EstudianteAsignaturaDocente</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">estudiante</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;EstudiantePeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;asignaturasDocentesEstudiante&#39;</span><span class="p">)</span>
    <span class="n">asignaturaDocente</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;AsignaturaDocente&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;estudiantesAsignaturaDocente&#39;</span><span class="p">,</span>
                                          <span class="n">verbose_name</span><span class="o">=</span><span class="s">&#39;Asignatura - Docente&#39;</span><span class="p">)</span>
    <span class="n">matricula</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">estado</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;60&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Haciendo uso de los getters, recuperamos datos como el área, carrera, etc.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignaturaDocente</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">area</span>
<span class="n">get_area</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Area&#39;</span>

<span class="k">def</span> <span class="nf">get_carrera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignaturaDocente</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">carrera</span><span class="p">[:</span><span class="mi">60</span><span class="p">]</span>
<span class="n">get_carrera</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Carrera&#39;</span>

<span class="k">def</span> <span class="nf">get_semestre</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignaturaDocente</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">semestre</span>
<span class="n">get_semestre</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Semestre&#39;</span>

<span class="k">def</span> <span class="nf">get_paralelo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignaturaDocente</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">paralelo</span>
<span class="n">get_paralelo</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Paralelo&#39;</span>

<span class="k">def</span> <span class="nf">get_nombre_corto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__unicode__</span><span class="p">()[:</span><span class="mi">60</span><span class="p">]</span>
<span class="n">get_nombre_corto</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Nombre&#39;</span>

<span class="k">def</span> <span class="nf">get_asignatura</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignaturaDocente</span><span class="o">.</span><span class="n">asignatura</span>
</pre></div>
</div>
<p>Campos para adicionar en el Admin a través del formulario <a class="reference internal" href="../Forms/forms.html#form-estudianteasignaturadocenteadminform"><em>Formulario EstudianteAsignaturaDocente</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">carrera</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_carrera</span><span class="p">,)</span>
<span class="n">semestre</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_semestre</span><span class="p">,)</span>
<span class="n">paralelo</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_paralelo</span><span class="p">,)</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">&#39;Estudiante Asignaturas&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;Estudiantes y Asignaturas&#39;</span>
    <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;estudiante&#39;</span><span class="p">,</span><span class="s">&#39;asignaturaDocente&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">u&quot;{0} &gt;&gt; {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estudiante</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignaturaDocente</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-asignaturadocente">
<span id="class-asignaturadocente"></span><h2>Clase AsignaturaDocente<a class="headerlink" href="#clase-asignaturadocente" title="Permalink to this headline">¶</a></h2>
<p>Una relación entre los docentes con sus respectivas asignaturas. Tenemos dos claves foraneas hacia la <a class="reference internal" href="#class-asignatura"><em>Clase Asignatura</em></a> y la <a class="reference internal" href="#class-docenteperiodoacademico"><em>Clase DocentePeriodoAcademico</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AsignaturaDocente</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">asignatura</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;Asignatura&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;docentesAsignatura&#39;</span><span class="p">)</span>
    <span class="n">docente</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;DocentePeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;asignaturasDocente&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Recuperación, mediante getters, de datos importantes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_idSGA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">idSGA</span>

<span class="k">def</span> <span class="nf">get_carrera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">carrera</span><span class="p">[:</span><span class="mi">60</span><span class="p">]</span>
<span class="n">get_carrera</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Carrera&#39;</span>

<span class="k">def</span> <span class="nf">get_semestre</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">semestre</span>
<span class="n">get_semestre</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Semestre&#39;</span>

<span class="k">def</span> <span class="nf">get_paralelo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">paralelo</span>
<span class="n">get_paralelo</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Paralelo&#39;</span>

<span class="k">def</span> <span class="nf">get_nombre_corto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ancho</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__unicode__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[:</span><span class="n">ancho</span><span class="p">]</span>
<span class="n">get_nombre_corto</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s">&#39;Nombre&#39;</span>
</pre></div>
</div>
<p>Campos para adicionar en el Admin a través del formulario  <a class="reference internal" href="../Forms/forms.html#form-estudianteasignaturadocenteadminform"><em>Formulario EstudianteAsignaturaDocente</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">carrera</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_carrera</span><span class="p">,)</span>
<span class="n">semestre</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_semestre</span><span class="p">,)</span>
<span class="n">paralelo</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_paralelo</span><span class="p">,)</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">&#39;Asignatura Docente&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;Asignaturas y Docentes&#39;</span>
    <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;docente&#39;</span><span class="p">,</span><span class="s">&#39;asignatura&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">u&quot;{0} &gt;&gt; {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docente</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignatura</span><span class="o">.</span><span class="n">nombre</span><span class="p">)</span>
</pre></div>
</div>
<p>Recuperar todas las carreras:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">carreras</span> <span class="o">=</span> <span class="n">Asignatura</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;carrera&#39;</span><span class="p">,</span> <span class="s">&#39;carrera&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;carrera&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-docenteperiodoacademico">
<span id="class-docenteperiodoacademico"></span><h2>Clase DocentePeriodoAcademico<a class="headerlink" href="#clase-docenteperiodoacademico" title="Permalink to this headline">¶</a></h2>
<p>Obtener todas las carreras y las almacenamos en una variable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">carreras</span> <span class="o">=</span> <span class="n">Asignatura</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;carrera&#39;</span><span class="p">,</span> <span class="s">&#39;carrera&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;carrera&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
</pre></div>
</div>
<p>Seguidamente se crea la clase que tiene como objetivo principal el relacionar a los docentes con sus respectivos periodos académicos:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">DocentePeriodoAcademico</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">usuario</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;Usuario&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;docentePeriodosAcademicos&#39;</span><span class="p">)</span>
    <span class="n">periodoAcademico</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;PeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;docentes&#39;</span><span class="p">,</span>
                                         <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Periodo Académico&#39;</span><span class="p">,</span> <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;periodo_academico_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>El siguiente atributo se agrega por efectos de migracion de docentes sin informacion de asignaturas:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">carrera</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;500&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">carreras</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>El siguiente atributo nos permite seleccionar si el docente pertenece o no a la Comision Academica de la Carrera:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">parAcademico</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">&#39;Docente&#39;</span>
    <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;usuario&#39;</span><span class="p">,</span><span class="s">&#39;periodoAcademico&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Continuamos con getters para recuperar información, en este caso se devolverá una lista de tuplas (carrera, area) pero unicamente del PeriodoAcademicoActual:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_carreras_areas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">lista_carreras_areas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lista_carreras_areas_query</span>  <span class="o">=</span> <span class="n">AsignaturaDocente</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">docente__periodoAcademico</span><span class="o">=</span><span class="n">Configuracion</span><span class="o">.</span><span class="n">getPeriodoAcademicoActual</span><span class="p">(),</span>
        <span class="n">docente__id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;asignatura__carrera&#39;</span><span class="p">,</span> <span class="s">&#39;asignatura__area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
    <span class="n">lista_carreras_areas</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lista_carreras_areas_query</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">carrera</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">carrera</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">lista_carreras_areas_query</span><span class="p">]:</span>
        <span class="n">lista_carreras_areas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">carrera</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">lista_carreras_areas</span>

<span class="k">def</span> <span class="nf">get_carreras</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_carreras_areas</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">get_areas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_carreras_areas</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">paralelos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asignaturasDocente</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;asignatura__area&#39;</span><span class="p">,</span> <span class="s">&#39;asignatura__carrera&#39;</span><span class="p">,</span>
                                        <span class="s">&#39;asignatura__semestre&#39;</span><span class="p">,</span><span class="s">&#39;asignatura__paralelo&#39;</span><span class="p">,</span>
                                        <span class="s">&#39;asignatura__seccion&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
    <span class="n">datos</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="s">&#39;area&#39;</span><span class="p">,</span><span class="s">&#39;carrera&#39;</span><span class="p">,</span><span class="s">&#39;modulo&#39;</span><span class="p">,</span><span class="s">&#39;paralelo&#39;</span><span class="p">,</span><span class="s">&#39;seccion&#39;</span><span class="p">),</span><span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">datos</span>


<span class="k">def</span> <span class="nf">cedula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">usuario</span><span class="o">.</span><span class="n">cedula</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">u&#39;{0} {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usuario</span><span class="o">.</span><span class="n">abreviatura</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">usuario</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-direccioncarrera">
<span id="class-direccioncarrera"></span><h2>Clase DireccionCarrera<a class="headerlink" href="#clase-direccioncarrera" title="Permalink to this headline">¶</a></h2>
<p>Para el funcionamiento normal de esta clase se necesitan recuperar datos existentes ya en la base de datos, es asi que a continuación se obtienen todas las carrera que riguen en el Periodo Académico Actual:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">carreras_areas</span> <span class="o">=</span> <span class="n">AsignaturaDocente</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">docente__periodoAcademico</span><span class="o">=</span><span class="n">Configuracion</span><span class="o">.</span><span class="n">getPeriodoAcademicoActual</span><span class="p">())</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span>
    <span class="s">&#39;asignatura__carrera&#39;</span><span class="p">,</span> <span class="s">&#39;asignatura__area&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span>
    <span class="s">&#39;asignatura__carrera&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
<span class="n">carreras_areas</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">),</span><span class="s">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span>  <span class="n">carreras_areas</span><span class="p">]</span>
<span class="c">#carreras_areas = ((&#39;energia&#39;,&#39;Energia&#39;),(&#39;medicina&#39;,&#39;Medicina&#39;))</span>
</pre></div>
</div>
<p>A continuación se estructura la clase para obtener las respectivas direcciones de carrera, para esto se especifica que docentes son coordinadores:</p>
<div class="highlight-python"><pre>class DireccionCarrera(models.Model):</pre>
</div>
<p>Nombre de la Carrera más el Área:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">carrera</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">carreras_areas</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                           <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Carrera-Area&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Director o Coordinador de Carrera:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">director</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;DocentePeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&quot;Coordinador&quot;</span><span class="p">,</span>
                             <span class="n">related_name</span><span class="o">=</span><span class="s">&quot;direcciones&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">u&quot;Coordinación {0} - {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">carrera</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">director</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="o">.</span><span class="n">rango</span><span class="p">())</span>
</pre></div>
</div>
<p>Se recupera docentes y se separa el área y la carrera:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_docentes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ids_docentes</span> <span class="o">=</span> <span class="n">AsignaturaDocente</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">asignatura__carrera</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">carrera</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">asignatura__area</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">carrera</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;docente__id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
    <span class="n">docentes</span> <span class="o">=</span> <span class="n">DocentePeriodoAcademico</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">periodoAcademico</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">director</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="p">,</span> <span class="n">id__in</span><span class="o">=</span><span class="n">ids_docentes</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span>
        <span class="s">&#39;usuario__last_name&#39;</span><span class="p">,</span> <span class="s">&#39;usuario__first_name&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">docentes</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;carrera&#39;</span><span class="p">]</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Coordinación de Carrera&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;Coordinaciones de Carreras&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-tipoinformante">
<span id="class-tipoinformante"></span><h2>Clase TipoInformante<a class="headerlink" href="#clase-tipoinformante" title="Permalink to this headline">¶</a></h2>
<p>El tipo de informánte que interactua con el sistema. Para el presente sistema tenemos informántes como: Estudiante, Docente, Directivo, EstrudianteMED, EstudiantesIdiomas, etc.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TipoInformante</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;50&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;200&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tipo</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;descripcion&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-cuestionario">
<span id="class-cuestionario"></span><h2>Clase Cuestionario<a class="headerlink" href="#clase-cuestionario" title="Permalink to this headline">¶</a></h2>
<p>Una de las clases más importantes. Encargada de almacenar el cuestionario que será desplegado para su contestación:</p>
<div class="highlight-python"><pre>class Cuestionario(models.Model):</pre>
</div>
<p>Nombre que se grabará en caso de no añadir un nombre para el cuestionario:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nombre</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;150&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;Cuestionario Sin Nombre&#39;</span><span class="p">)</span>
<span class="n">titulo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;255&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Frase para el encabezado de la encuesta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">encabezado</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
</pre></div>
</div>
<p>El lapso de tiempo que estará vigente el cuestionario para su contestación:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">inicio</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="s">u&#39;Inicio de la Encuesta&#39;</span><span class="p">)</span>
<span class="n">fin</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="s">u&#39;Finalización de la Encuesta&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Permite seleccionar la obligatoriedad de todas las preguntas del cuestionario:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">preguntas_obligatorias</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">informante</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">TipoInformante</span><span class="p">)</span>
</pre></div>
</div>
<p>El peso que tendrán cada pregunta, esto se da generalmente de acuerdo al Tipo de Informante:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">peso</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">periodoEvaluacion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;PeriodoEvaluacion&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                      <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;cuestionarios&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Periodo de Evaluación&#39;</span>
                                      <span class="p">)</span>
</pre></div>
</div>
<p>Método que permite obtener todas las preguntas de todas las secciones y subsecciones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_preguntas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">preguntas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">secciones</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">preguntas</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get_preguntas</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">preguntas</span>
</pre></div>
</div>
<p>El siguiente método crea una copia de un cuestionario incluyendo todas sus secciones y todas sus preguntas. Teniendo en cuenta que todos los objetos involucrados seran objetos nuevos:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">clonar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">numero</span> <span class="o">=</span> <span class="n">Cuestionario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">nuevo</span> <span class="o">=</span> <span class="n">Cuestionario</span><span class="p">()</span>
    <span class="n">nuevo</span><span class="o">.</span><span class="n">titulo</span> <span class="o">=</span> <span class="s">u&#39;{0} (Clonado {1})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">titulo</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">numero</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">nuevo</span><span class="o">.</span><span class="n">encabezado</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encabezado</span>
    <span class="n">nuevo</span><span class="o">.</span><span class="n">inicio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inicio</span>
    <span class="n">nuevo</span><span class="o">.</span><span class="n">fin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fin</span>
    <span class="c"># No se relacionan para mayor flexibilidad</span>
    <span class="n">nuevo</span><span class="o">.</span><span class="n">informante</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">nuevo</span><span class="o">.</span><span class="n">periodoEvaluacion</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">nuevo</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">seccion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">secciones</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">nuevaSeccion</span> <span class="o">=</span> <span class="n">Seccion</span><span class="p">()</span>
        <span class="n">nuevaSeccion</span><span class="o">.</span><span class="n">titulo</span> <span class="o">=</span> <span class="n">seccion</span><span class="o">.</span><span class="n">titulo</span>
        <span class="n">nuevaSeccion</span><span class="o">.</span><span class="n">descripcion</span> <span class="o">=</span> <span class="n">seccion</span><span class="o">.</span><span class="n">descripcion</span>
        <span class="n">nuevaSeccion</span><span class="o">.</span><span class="n">orden</span> <span class="o">=</span> <span class="n">seccion</span><span class="o">.</span><span class="n">orden</span>
        <span class="n">nuevaSeccion</span><span class="o">.</span><span class="n">seccionPadre</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">nuevaSeccion</span><span class="o">.</span><span class="n">cuestionario</span> <span class="o">=</span> <span class="n">nuevo</span>
        <span class="n">nuevaSeccion</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pregunta</span> <span class="ow">in</span> <span class="n">seccion</span><span class="o">.</span><span class="n">preguntas</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">nuevaPregunta</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="p">()</span>
            <span class="n">nuevaPregunta</span><span class="o">.</span><span class="n">texto</span> <span class="o">=</span> <span class="n">pregunta</span><span class="o">.</span><span class="n">texto</span>
            <span class="n">nuevaPregunta</span><span class="o">.</span><span class="n">orden</span> <span class="o">=</span> <span class="n">pregunta</span><span class="o">.</span><span class="n">orden</span>
            <span class="n">nuevaPregunta</span><span class="o">.</span><span class="n">tipo</span> <span class="o">=</span> <span class="n">pregunta</span><span class="o">.</span><span class="n">tipo</span>
            <span class="n">nuevaPregunta</span><span class="o">.</span><span class="n">seccion</span> <span class="o">=</span> <span class="n">nuevaSeccion</span>
            <span class="n">nuevaPregunta</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pregunta</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">nuevoItem</span> <span class="o">=</span> <span class="n">ItemPregunta</span><span class="p">()</span>
                <span class="n">nuevoItem</span><span class="o">.</span><span class="n">texto</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">texto</span>
                <span class="n">nuevoItem</span><span class="o">.</span><span class="n">orden</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">orden</span>
                <span class="n">nuevoItem</span><span class="o">.</span><span class="n">pregunta</span> <span class="o">=</span> <span class="n">nuevaPregunta</span>
                <span class="n">nuevoItem</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nuevo</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-contestacion">
<span id="class-contestacion"></span><h2>Clase Contestacion<a class="headerlink" href="#clase-contestacion" title="Permalink to this headline">¶</a></h2>
<p>Permite gestionar las contestaciones de las evaluaciones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Contestacion</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">pregunta</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">respuesta</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
</pre></div>
</div>
<p>Adicionales a la respuesta propiamente establecida:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">observaciones</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Clave foránea hacia la <a class="reference internal" href="#class-evaluacion"><em>Clase Evaluacion</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">evaluacion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;Evaluacion&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;contestaciones&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A continuación se devuelve el objeto <cite>pregunta</cite> a partir del atributo <cite>id_pregunta</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_pregunta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pregunta</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">&#39;Respuesta&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;Respuestas&#39;</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">u&#39;{0}:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pregunta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">respuesta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-evaluacion">
<span id="class-evaluacion"></span><h2>Clase Evaluacion<a class="headerlink" href="#clase-evaluacion" title="Permalink to this headline">¶</a></h2>
<p>Contiene la estructura básica para la evaluación que se realizará:</p>
<div class="highlight-python"><pre>class Evaluacion(models.Model):</pre>
</div>
<p>Delega la lógica que determina el tipo de evaluación a los controladores. Se puede acceder a las evaluaciones y autoevaluaciones directamente. Para acceder a las evaluaciones de los estudiantes utilizar <a class="reference internal" href="#class-estudianteasignaturadocente"><em>Clase EstudianteAsignaturaDocente</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fechaInicio</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
<span class="n">fechaFin</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
<span class="n">horaInicio</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TimeField</span><span class="p">()</span>
<span class="n">horaFin</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TimeField</span><span class="p">()</span>
</pre></div>
</div>
<p>Enlace hacia la <a class="reference internal" href="#class-cuestionario"><em>Clase Cuestionario</em></a> con el fin de obtener los cuestionarios para llevar a cavo la evaluación:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cuestionario</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;Cuestionario&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;evaluaciones&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Evaluaciones de ESTUDIANTES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">estudianteAsignaturaDocente</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;EstudianteAsignaturaDocente&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;evaluaciones&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Evaluaciones de DOCENTES. Pueden ser evaluaciones y autoevaluaciones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">docentePeriodoAcademico</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;DocentePeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;evaluaciones&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Evaluaciones de PARES ACADEMICOS y # Docente Par Academico:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">parAcademico</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;DocentePeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;evaluaciones_par_academico&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Evaluaciones de DIRECCIONES DE CARRERA # Docente Director:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">directorCarrera</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;DocentePeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;evaluaciones_director&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Evaluaciones de DIRECCIONES DE CARRERA # Nombre de la Carrera mas el Area:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">carreraDirector</span> <span class="o">=</span>  <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">carreras_areas</span><span class="p">,</span>
                                    <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Carrera-Area&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Metodo principal que define el comportamiento del evaluador y sus distintos roles:</p>
<div class="highlight-python"><pre>def evaluador(self):</pre>
</div>
<p>Evaluacion del Estudiante a sus docentes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estudianteAsignaturaDocente</span><span class="p">:</span>
    <span class="n">evaluador</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estudianteAsignaturaDocente</span><span class="o">.</span><span class="n">estudiante</span>
</pre></div>
</div>
<p>Evaluacion del Director de Carrera:</p>
<div class="highlight-python"><pre>elif self.directorCarrera and self.docentePeriodoAcademico:
    evaluador = self.directorCarrera</pre>
</div>
<p>Evaluacion del Par Academico de la Carrera:</p>
<div class="highlight-python"><pre>elif self.parAcademico and self.docentePeriodoAcademico:
    evaluador = self.parAcademico</pre>
</div>
<p>Autoevaluacion del docente:</p>
<div class="highlight-python"><pre>elif self.docentePeriodoAcademico:
    evaluador = self.docentePeriodoAcademico
return evaluador</pre>
</div>
<p>El siguiente método define el comportamiento del evaluado:</p>
<div class="highlight-python"><pre>def evaluado(self):</pre>
</div>
<p>Evaluacion del Estudiante a sus docentes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estudianteAsignaturaDocente</span><span class="p">:</span>
    <span class="n">evaluado</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estudianteAsignaturaDocente</span><span class="o">.</span><span class="n">asignaturaDocente</span><span class="o">.</span><span class="n">docente</span>
</pre></div>
</div>
<p>Evaluacion del Director de la Carrera al docente:</p>
<div class="highlight-python"><pre>elif self.directorCarrera and self.docentePeriodoAcademico:
    evaluado = self.docentePeriodoAcademico</pre>
</div>
<p>Evaluacion del Par Academico de la Carrera al docente:</p>
<div class="highlight-python"><pre>elif self.parAcademico and self.docentePeriodoAcademico:
    evaluado = self.docentePeriodoAcademico</pre>
</div>
<p>Autoevaluacion del docente:</p>
<div class="highlight-python"><pre>    elif self.docentePeriodoAcademico:
        evaluado = self.docentePeriodoAcademico
    return evaluado

class Meta:
    verbose_name_plural = 'Evaluaciones'

def __unicode__(self):
    return u'{0} - {1} - {2}|{3} - {4}|{5} - {6}'.format(
        self.evaluador().director.cedula() if isinstance(self.evaluador(), DireccionCarrera) else self.evaluador().cedula(),
        self.evaluado().cedula(),
        self.fechaInicio, self.horaInicio, self.fechaFin, self.horaFin,
        self.cuestionario.informante
        )</pre>
</div>
</div>
<div class="section" id="clase-resultados">
<span id="class-resultados"></span><h2>Clase Resultados<a class="headerlink" href="#clase-resultados" title="Permalink to this headline">¶</a></h2>
<p>Clase para forzar un enlace desde al admin de la app:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Resultados</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;Resultados&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-tipopregunta">
<span id="class-tipopregunta"></span><h2>Clase TipoPregunta<a class="headerlink" href="#clase-tipopregunta" title="Permalink to this headline">¶</a></h2>
<p>Clase Abstracta relacionada con el tipo de pregunta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TipoPregunta</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;20&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;100&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tipo</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-seleccionunica">
<span id="class-seleccionunica"></span><h2>Clase SeleccionUnica<a class="headerlink" href="#clase-seleccionunica" title="Permalink to this headline">¶</a></h2>
<p>Esta clase esta relacionada con la forma de selección de las respuestas de la encuesta, en este caso el tipo de seleccción es unica es decir mediante el uso de radio buttons:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SeleccionUnica</span><span class="p">(</span><span class="n">TipoPregunta</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TipoPregunta</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tipo</span> <span class="o">=</span> <span class="s">&#39;SeleccionUnica&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">descripcion</span> <span class="o">=</span> <span class="s">&#39;Se visualiza  radio buttons&#39;</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&#39;Selección Única&#39;</span>
</pre></div>
</div>
<span class="target" id="class-ensayo"></span></div>
<div class="section" id="clase-seccion">
<span id="class-seccion"></span><h2>Clase Seccion<a class="headerlink" href="#clase-seccion" title="Permalink to this headline">¶</a></h2>
<p>Esta clase tiene como finalidad agrupar los custionarios en distintas secciones:</p>
<div class="highlight-python"><pre>class Seccion(models.Model):</pre>
</div>
<p>Nombre corto para identificacion de objeto:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nombre</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;150&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">u&#39;Sección de Cuestionario Sin Nombre&#39;</span><span class="p">)</span>
<span class="n">titulo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;200&#39;</span><span class="p">)</span>
<span class="n">descripcion</span>  <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">orden</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
<span class="n">codigo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;20&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ponderacion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Una subseccion esta relacionada con otra Seccion en vez de un Cuestionario:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">superseccion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;self&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;superseccion_id&#39;</span><span class="p">,</span>
                                 <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;subsecciones&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Sección Padre&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Una seccion normalmente esta relacionada con un Cuestionario:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cuestionario</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Cuestionario</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;secciones&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Metodo recursivo hasta llegar a la seccion padre que tiene Cuestionario:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_cuestionario</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">superseccion</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">superseccion</span><span class="o">.</span><span class="n">get_cuestionario</span><span class="p">()</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cuestionario</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cuestionario</span>
</pre></div>
</div>
<p>Metodo recursivo hasta llegar a las secciones que no tiene subsecciones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_preguntas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">preguntas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsecciones</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsecciones</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">preguntas</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">get_preguntas</span><span class="p">())</span>
    <span class="n">preguntas</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preguntas</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">preguntas</span>

<span class="k">def</span> <span class="nf">preguntas_ordenadas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pregunta_set</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;orden&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cuestionario</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">u&#39;Sección  {0} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">superseccion</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">u&#39;Subsección {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nombre</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;orden&#39;</span><span class="p">]</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;sección&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;secciones&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-pregunta">
<span id="class-pregunta"></span><h2>Clase Pregunta<a class="headerlink" href="#clase-pregunta" title="Permalink to this headline">¶</a></h2>
<p>Contiene la estructura que tendrán las preguntas de los cuestionarios y con que otras clases estarán relacionadas:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Pregunta</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">codigo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;20&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">texto</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Observaciones adicionales a la contestacion o respuesta. Se almacena solo un titulo o tema de las observaciones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">observaciones</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;70&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">orden</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
<span class="n">tipo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">TipoPregunta</span><span class="p">)</span>
<span class="n">seccion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Seccion</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;preguntas&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Devuelve el codigo de la seccion mas el de la pregunta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_codigo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">codigo_seccion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seccion</span><span class="o">.</span><span class="n">codigo</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seccion</span><span class="o">.</span><span class="n">orden</span><span class="p">)</span>
    <span class="n">codigo_pregunta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codigo</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orden</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">&#39;{0}.{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">codigo_seccion</span><span class="p">,</span> <span class="n">codigo_pregunta</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">document_fromstring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">texto</span><span class="p">)</span>
    <span class="n">texto</span> <span class="o">=</span> <span class="s">u&#39;{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">text_content</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">texto</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;seccion__orden&#39;</span><span class="p">,</span> <span class="s">&#39;orden&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-itempregunta">
<span id="class-itempregunta"></span><h2>Clase ItemPregunta<a class="headerlink" href="#clase-itempregunta" title="Permalink to this headline">¶</a></h2>
<p>Esta clase se diseñó con el fin de proporcionar las posibilidades de respuestas a las preguntas realizadas en el cuestionario:</p>
<div class="highlight-python"><pre>class ItemPregunta(models.Model):</pre>
</div>
<p>Valor para la contestación de la pregunta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">texto</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;50&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Notas adicionales aclaratorias para el Item de pregunta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;70&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Clave foránea hacia la <a class="reference internal" href="#class-pregunta"><em>Clase Pregunta</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pregunta</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Pregunta</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;items&#39;</span><span class="p">)</span>
<span class="n">orden</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">texto</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;-orden&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-areasga">
<span id="class-areasga"></span><h2>Clase AreaSGA<a class="headerlink" href="#clase-areasga" title="Permalink to this headline">¶</a></h2>
<p>Clase destinada para la administración de areas pertenecientes al Sistema de Gestión Académico(SGA):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AreaSGA</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">siglas</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;10&#39;</span><span class="p">)</span>
    <span class="n">nombre</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;256&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">siglas</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-periodoevaluacion">
<span id="class-periodoevaluacion"></span><h2>Clase PeriodoEvaluacion<a class="headerlink" href="#clase-periodoevaluacion" title="Permalink to this headline">¶</a></h2>
<p>La presente clase tiene como finalidad ubicarnos en el presente periodo de evaluación:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PeriodoEvaluacion</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">nombre</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;100&#39;</span><span class="p">)</span>
    <span class="n">titulo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;300&#39;</span><span class="p">)</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">observaciones</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">inicio</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>
    <span class="n">fin</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>
</pre></div>
</div>
<p>Clave foránea hacia la <a class="reference internal" href="#class-periodoacademico"><em>Clase PeriodoAcademico</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">periodoAcademico</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;PeriodoAcademico&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;periodosEvaluacion&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">&quot;Periodo Académico&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Relación muchos a muchos con la <a class="reference internal" href="#class-areasga"><em>Clase AreaSGA</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">areasSGA</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">AreaSGA</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;periodosEvaluacion&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Areas Académicas SGA&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;inicio&#39;</span><span class="p">,</span> <span class="s">&#39;fin&#39;</span><span class="p">]</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Periodo Evaluación&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Periodos de Evaluación&#39;</span>
</pre></div>
</div>
<p>Métodos para configuración de fechas:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">noIniciado</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ahora</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ahora</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">inicio</span>

<span class="k">def</span> <span class="nf">vigente</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ahora</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inicio</span> <span class="o">&lt;=</span>  <span class="n">ahora</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fin</span>

<span class="k">def</span> <span class="nf">finalizado</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ahora</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ahora</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">fin</span>
</pre></div>
</div>
<p>El siguiente método analiza si el Estudiante a realizado todas las evaluaciones que le corresponden en este Periodo de Evaluación:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">verificar_estudiante</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cedula</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">EstudiantePeriodoAcademico</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">usuario__cedula</span><span class="o">=</span><span class="n">cedula</span><span class="p">,</span> <span class="n">periodoAcademico</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">EstudiantePeriodoAcademico</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
        <span class="n">logg</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&#39;Verificar estudiante: dni {} no existe&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cedula</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="n">evaluaciones</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">estudianteAsignaturaDocente__estudiante__usuario__cedula</span><span class="o">=</span><span class="n">cedula</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">EstudianteAsignaturaDocente</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">estudiante__usuario__cedula</span><span class="o">=</span><span class="n">cedula</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">estudiante__periodoAcademico</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">restantes</span> <span class="o">=</span> <span class="n">total</span> <span class="o">-</span> <span class="n">evaluaciones</span>
    <span class="n">mensaje</span> <span class="o">=</span> <span class="s">u&quot;{0}: total {1}, evaluados {2}, restan {3} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cedula</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">evaluaciones</span><span class="p">,</span> <span class="n">restantes</span><span class="p">)</span>
    <span class="n">logg</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">mensaje</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">restantes</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
</pre></div>
</div>
<p>Este método contabiliza las distintas evaluaciones realizadas por los Estudiantes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">contabilizar_evaluaciones_estudiantes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">carrera</span><span class="p">,</span> <span class="n">semestre</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">paralelo</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">consulta</span> <span class="o">=</span> <span class="n">EstudianteAsignaturaDocente</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">estudiante__periodoAcademico</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="p">,</span>
        <span class="n">asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span>
        <span class="n">asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">carrera</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">semestre</span> <span class="ow">and</span> <span class="n">semestre</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
        <span class="n">consulta</span> <span class="o">=</span> <span class="n">consulta</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">asignaturaDocente__asignatura__semestre</span><span class="o">=</span><span class="n">semestre</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">paralelo</span> <span class="ow">and</span> <span class="n">paralelo</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
        <span class="n">consulta</span> <span class="o">=</span> <span class="n">consulta</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">asignaturaDocente__asignatura__paralelo</span><span class="o">=</span><span class="n">paralelo</span><span class="p">)</span>
    <span class="n">estudiantes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">estudiante</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">consulta</span><span class="o">.</span><span class="n">all</span><span class="p">()])</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">estudiantes</span><span class="p">)</span>
    <span class="n">completados</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">faltantes</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">estudiantes</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verificar_estudiante</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">usuario</span><span class="o">.</span><span class="n">cedula</span><span class="p">):</span>
            <span class="n">completados</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">faltantes</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">estudiantes</span><span class="o">=</span><span class="n">total</span><span class="p">,</span> <span class="n">completados</span><span class="o">=</span><span class="n">completados</span><span class="p">,</span> <span class="n">faltantes</span><span class="o">=</span><span class="n">faltantes</span><span class="p">)</span>
</pre></div>
</div>
<p>A continuación el método <tt class="docutils literal"><span class="pre">contabilizar_evaluadores</span></tt> cuenta los estudiantes, pares academicos y directores que HAYAN EVALUADO a por lo menos un docente. No se controla haber evaluado a todos los docentes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">contabilizar_evaluadores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">estudiantes</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span>
        <span class="s">&#39;estudianteAsignaturaDocente__estudiante&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">docentes</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">docentePeriodoAcademico__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">directorCarrera__isnull</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">parAcademico__isnull</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">pares</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">parAcademico__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
        <span class="s">&#39;parAcademico&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">directores</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">directorCarrera__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
        <span class="s">&#39;directorCarrera&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">estudiantes</span><span class="o">=</span><span class="n">estudiantes</span><span class="p">,</span> <span class="n">docentes</span><span class="o">=</span><span class="n">docentes</span><span class="p">,</span> <span class="n">pares</span><span class="o">=</span><span class="n">pares</span><span class="p">,</span> <span class="n">directores</span><span class="o">=</span><span class="n">directores</span><span class="p">)</span>
</pre></div>
</div>
<p>Metodo que permite contar los estudiantes, pares academicos y directores que HAN SIDO EVALUADOS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">contabilizar_evaluados</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">porEstudiantes</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">estudianteAsignaturaDocente__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span>
        <span class="s">&#39;estudianteAsignaturaDocente__asignaturaDocente__docente&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">porDocentes</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">docentePeriodoAcademico__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">directorCarrera__isnull</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">parAcademico__isnull</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">porPares</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">parAcademico__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
        <span class="s">&#39;docentePeriodoAcademico&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">porDirectores</span> <span class="o">=</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">directorCarrera__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
        <span class="s">&#39;docentePeriodoAcademico&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">porEstudiantes</span><span class="o">=</span><span class="n">porEstudiantes</span><span class="p">,</span> <span class="n">porDocentes</span><span class="o">=</span><span class="n">porDocentes</span><span class="p">,</span> <span class="n">porPares</span><span class="o">=</span><span class="n">porPares</span><span class="p">,</span> <span class="n">porDirectores</span><span class="o">=</span><span class="n">porDirectores</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nombre</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-tabulacion">
<span id="class-tabulacion"></span><h2>Clase Tabulacion<a class="headerlink" href="#clase-tabulacion" title="Permalink to this headline">¶</a></h2>
<p>Antes de la creación de la clase, se recuperan datos datos existentes ya en la base de datos con el fin de obtener los tipos de tabulaciones que el sistema puede realizar:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># TODO: Modelar de mejor manera la funcionalidad</span>
<span class="n">tipos_tabulacion</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s">u&#39;ESE2012&#39;</span><span class="p">,</span> <span class="s">u&#39;Tabulación Satisfacción Estudiantil 2012&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">u&#39;EAAD2012&#39;</span><span class="p">,</span> <span class="s">u&#39;Tabulación Actividades Adicionales Docencia 2011-2012&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">u&#39;EDD2013&#39;</span><span class="p">,</span> <span class="s">u&#39;Tabulación Evaluación del Desempeño Docente 2012-2013&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Está estructurada como una superclase que permite procesar la informacion generada por un conjunto de encuestas pertenecientes a un Periodo de Evaluación:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Tabulacion</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;250&#39;</span><span class="p">)</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span> <span class="n">max_length</span><span class="o">=</span><span class="s">&#39;20&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">tipos_tabulacion</span><span class="p">)</span>
</pre></div>
</div>
<p>Relación uno a uno con la <a class="reference internal" href="#class-periodoevaluacion"><em>Clase PeriodoEvaluacion</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">periodoEvaluacion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="s">&#39;PeriodoEvaluacion&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;tabulacion&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&quot;Tabulaciones&quot;</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">descripcion</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-tabulacionevaluacion2013">
<span id="class-tabulacionevaluacion2013"></span><h2>Clase TabulacionEvaluacion2013<a class="headerlink" href="#clase-tabulacionevaluacion2013" title="Permalink to this headline">¶</a></h2>
<p>Esta clase se encarga del levantamiento y presentación de resultados de la evaluación 2013:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TabulacionEvaluacion2013</span><span class="p">:</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="s">u&#39;EDA2013&#39;</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="s">u&#39;Evaluación del Desempeño Docente 2012-2013&#39;</span>
</pre></div>
</div>
<p>Constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periodoEvaluacion</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span> <span class="o">=</span> <span class="n">periodoEvaluacion</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">calculos</span> <span class="o">=</span> <span class="p">(</span>

        <span class="c"># codigo, descripcion, metodo, titulo</span>

        <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">u&#39;Resultados de la Evaluación del Desempeño Académico POR DOCENTE&#39;</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">por_docente</span><span class="p">,</span> <span class="s">u&#39;Evaluación del Desempeño Académico por Docente&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">u&#39;Resultados de la Evaluación del Desempeño Académico POR CARRERA&#39;</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">por_carrera</span><span class="p">,</span> <span class="s">u&#39;Evaluación del Desempeño Académico por Carrera&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">u&#39;Resultados de la Evaluación del Desempeño Académico POR AREA&#39;</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">por_area</span><span class="p">,</span> <span class="s">u&#39;Evaluación del Desempeño Académico por Area&#39;</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Calculo de resultados por docentes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">por_docente</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">id_docente</span><span class="p">,</span> <span class="n">componente</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

    <span class="c"># Se pasa un tupla no un solo id</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcular</span><span class="p">(</span><span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="p">(</span><span class="n">id_docente</span><span class="p">,),</span> <span class="n">componente</span><span class="p">)</span>
</pre></div>
</div>
<p>Método para obtener resultados por carreras:</p>
<div class="highlight-python"><pre>def por_carrera(self, siglas_area, nombre_carrera, componente):</pre>
</div>
<p>Obtenemos los id de los Docentes que dictan Asignaturas en la carrera seleccionada:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">aux_ids</span> <span class="o">=</span> <span class="n">AsignaturaDocente</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">docente__periodoAcademico</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="p">,</span>
    <span class="n">asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">,</span>
    <span class="n">asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span>
    <span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;docente__id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
</pre></div>
</div>
<p>Se agregan también los docentes que no tengan Asignaturas pero que pertenezcan a la Carrera:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ids_docentes</span> <span class="o">=</span> <span class="n">DocentePeriodoAcademico</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">Q</span><span class="p">(</span><span class="n">periodoAcademico</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="p">)</span> <span class="ow">and</span>
    <span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">id__in</span><span class="o">=</span><span class="n">aux_ids</span><span class="p">)</span> <span class="ow">or</span> <span class="n">Q</span><span class="p">(</span><span class="n">carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;usuario__last_name&#39;</span><span class="p">,</span> <span class="s">&#39;usuario__first_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span>
    <span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>
<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcular</span><span class="p">(</span><span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">ids_docentes</span><span class="p">,</span> <span class="n">componente</span><span class="p">)</span>
</pre></div>
</div>
<p>Método para cálculo por área:</p>
<div class="highlight-python"><pre>def por_area(self, siglas_area, componente=None):</pre>
</div>
<p>Obtenemos los id de los Docentes que dictan Asignaturas en el area seleccionada:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">aux_ids</span> <span class="o">=</span> <span class="n">AsignaturaDocente</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">docente__periodoAcademico</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="p">,</span>
    <span class="n">asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span>
    <span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;docente__id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
</pre></div>
</div>
<p>Se agregan tambien los docentes que no tengan Asignaturas pero que pertenezcan a la Carrera:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ids_docentes</span> <span class="o">=</span> <span class="n">DocentePeriodoAcademico</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">Q</span><span class="p">(</span><span class="n">periodoAcademico</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">periodoAcademico</span><span class="p">)</span> <span class="ow">and</span>
    <span class="p">(</span> <span class="n">Q</span><span class="p">(</span><span class="n">id__in</span><span class="o">=</span><span class="n">aux_ids</span><span class="p">)</span> <span class="p">)</span><span class="c">#TODO: No hay el area en el atributo Carrera de DocentePeriodoAcademico</span>
    <span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;usuario__last_name&#39;</span><span class="p">,</span> <span class="s">&#39;usuario__first_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span>
    <span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>
<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcular</span><span class="p">(</span><span class="n">siglas_area</span><span class="p">,</span> <span class="bp">None</span> <span class="p">,</span> <span class="n">ids_docentes</span><span class="p">,</span> <span class="n">componente</span><span class="p">)</span>
</pre></div>
</div>
<p>Método genérico para calcular los resultados de acuerdo a los diferentes criterios. Si se trata del reporte de sugerencias se salta al método respectivo:</p>
<div class="highlight-python"><pre>def calcular(self, siglas_area, nombre_carrera, ids_docentes, componente=None):
    if componente == 'sugerencias':
        return self.extraer_sugerencias(siglas_area, nombre_carrera, ids_docentes)

    resultados_indicadores = {}
    pesos = {}
    if siglas_area == 'ACE':
        tipos = ('EstudianteIdiomas', 'DocenteIdiomas', 'ParAcademicoIdiomas', 'DirectivoIdiomas')
    else:
        tipos = ('Estudiante', 'Docente', 'ParAcademico', 'Directivo')
    if not componente:
        seccion_componente = None
    else:</pre>
</div>
<p>Se pasa de <tt class="docutils literal"><span class="pre">string</span></tt> a objeto seccion para sacar datos en la plantilla:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">seccion_componente</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">,</span> <span class="n">codigo</span><span class="o">=</span><span class="n">componente</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Se obtinen los promedios tomando en cuenta cada indicador:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">tipo</span> <span class="ow">in</span> <span class="n">tipos</span><span class="p">:</span>
    <span class="n">cuestionario</span> <span class="o">=</span> <span class="n">Cuestionario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">,</span> <span class="n">informante__tipo</span><span class="o">=</span><span class="n">tipo</span><span class="p">)</span>
</pre></div>
</div>
<p>En caso de tratarse del insituto de idiomas se generaliza el informante:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">informante</span> <span class="o">=</span> <span class="n">tipo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;idiomas&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Actualizar datos de peso:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pesos</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">informante</span> <span class="p">:</span> <span class="n">cuestionario</span><span class="o">.</span><span class="n">peso</span><span class="p">})</span>
</pre></div>
</div>
<p>Recorriendo preguntas:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="ow">not</span> <span class="n">componente</span><span class="p">:</span>
    <span class="n">preguntas</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">cuestionario</span><span class="o">.</span><span class="n">get_preguntas</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">tipo</span><span class="o">==</span><span class="n">TipoPregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tipo</span><span class="o">=</span><span class="s">&#39;SeleccionUnica&#39;</span><span class="p">)]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">preguntas</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">cuestionario</span><span class="o">.</span><span class="n">get_preguntas</span><span class="p">()</span> <span class="k">if</span>
                 <span class="n">p</span><span class="o">.</span><span class="n">tipo</span><span class="o">==</span><span class="n">TipoPregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tipo</span><span class="o">=</span><span class="s">&#39;SeleccionUnica&#39;</span><span class="p">)</span> <span class="ow">and</span>
                 <span class="n">p</span><span class="o">.</span><span class="n">seccion</span><span class="o">.</span><span class="n">superseccion</span><span class="o">.</span><span class="n">codigo</span><span class="o">==</span><span class="n">componente</span> <span class="p">]</span>
</pre></div>
</div>
<p>recorrido de contestaciones:</p>
<div class="highlight-python"><pre>contestaciones = None
if informante == 'estudiante':
    contestaciones = Contestacion.objects.filter(
        evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id__in=ids_docentes,
        pregunta__in=preguntas).values_list('id', flat=True)
elif informante == 'docente':
    contestaciones = Contestacion.objects.filter(
        evaluacion__parAcademico__isnull=True, evaluacion__directorCarrera__isnull=True,
        evaluacion__docentePeriodoAcademico__id__in=ids_docentes, pregunta__in=preguntas
        ).values_list('id', flat=True)
elif informante == 'paracademico':
    contestaciones = Contestacion.objects.filter(
        evaluacion__parAcademico__isnull=False, evaluacion__directorCarrera__isnull=True,
        evaluacion__docentePeriodoAcademico__id__in=ids_docentes, pregunta__in=preguntas
        ).values_list('id', flat=True)
elif informante == 'directivo':
    contestaciones = Contestacion.objects.filter(
        evaluacion__directorCarrera__isnull=False, evaluacion__parAcademico__isnull=True,
        evaluacion__docentePeriodoAcademico__id__in=ids_docentes, pregunta__in=preguntas
        ).values_list('id', flat=True)
if contestaciones:</pre>
</div>
<p>Otencion de promedios por pregunta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;SELECT pregunta, AVG(respuesta::INT) FROM app_contestacion</span>
<span class="s">       WHERE id IN </span><span class="si">%s</span><span class="s"> GROUP BY pregunta&quot;&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">contestaciones</span><span class="p">)])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Si el informante no ha contestado el cuestionario correspondiente:</p>
<div class="highlight-python"><pre>else:
    logg.warning('No hay evaluaciones del informante {0} para los docentes {1}'.format(tipo,ids_docentes))
    print "No hay contestaciones de " + tipo + ' para ' + str(ids_docentes)
    result = [(id, 0.0) for id in preguntas]</pre>
</div>
<p>A continuación se crea un diccionario a partir de lista compresa de tuplas conformadas por ids de pregunta con sus promedio:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">promedios_preguntas</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">id_pregunta</span><span class="p">),</span> <span class="n">promedio</span><span class="p">)</span> <span class="k">for</span> <span class="n">id_pregunta</span><span class="p">,</span> <span class="n">promedio</span> <span class="ow">in</span> <span class="n">result</span><span class="p">])</span>
<span class="n">indicadores</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
<p>Sumatorias por pregunta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">pregunta</span><span class="p">,</span> <span class="n">promedio</span> <span class="ow">in</span> <span class="n">promedios_preguntas</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">suma</span> <span class="o">=</span> <span class="n">indicadores</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pregunta</span><span class="o">.</span><span class="n">seccion</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">promedio</span>
    <span class="c">###indicadores[pregunta.seccion] = suma</span>
    <span class="n">indicadores</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">pregunta</span><span class="o">.</span><span class="n">seccion</span><span class="p">:</span> <span class="n">suma</span><span class="p">})</span>
</pre></div>
</div>
<p>Promedio por seccion (indicador):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">seccion</span><span class="p">,</span> <span class="n">suma</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">promedio</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">suma</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">seccion</span><span class="o">.</span><span class="n">preguntas</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
    <span class="n">indicadores</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">seccion</span> <span class="p">:</span> <span class="n">promedio</span><span class="p">})</span>
</pre></div>
</div>
<p>Porcentaje por seccion (indicador):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ESCALA_MAXIMA</span> <span class="o">=</span> <span class="mi">4</span>
<span class="k">for</span> <span class="n">seccion</span><span class="p">,</span> <span class="n">promedio</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">porcentaje</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="mi">100</span> <span class="o">*</span> <span class="n">promedio</span><span class="p">)</span> <span class="o">/</span> <span class="n">ESCALA_MAXIMA</span><span class="p">)</span>
    <span class="n">indicadores</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">seccion</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">porcentaje</span><span class="p">)})</span>
</pre></div>
</div>
<p>Genera diccionario de diccionarios. Los &#8216;Objetos&#8217; Seccion son diferentes pues pertenecen a Cuestionarios diferentes por tal motivo se usa el codigo como clave del diccionario para sumarizar los porcentajes de las secciones con el mismo codigo en todos los Cuestionarios:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">seccion</span><span class="p">,</span> <span class="n">porcentaje</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">indicador</span> <span class="o">=</span> <span class="n">resultados_indicadores</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">seccion</span><span class="o">.</span><span class="n">codigo</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">indicador</span><span class="p">:</span>
        <span class="c"># Se guarda el atributo ponderacion solo la primera vez para luego calcular</span>
        <span class="c"># Puesto que todas las secciones tienes los mismos datos</span>

        <span class="n">indicador</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;informantes&#39;</span> <span class="p">:</span> <span class="p">{},</span> <span class="s">&#39;ponderacion_seccion&#39;</span> <span class="p">:</span> <span class="n">seccion</span><span class="o">.</span><span class="n">ponderacion</span><span class="p">}</span>

    <span class="c"># Se inserta ademas el objeto Seccion el indicador para disponer de informacion extra en el template</span>

    <span class="n">indicador</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;objeto_seccion&#39;</span> <span class="p">:</span> <span class="n">seccion</span><span class="p">})</span>
    <span class="n">indicador</span><span class="p">[</span><span class="s">&#39;informantes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="n">informante</span> <span class="p">:</span> <span class="n">porcentaje</span> <span class="p">})</span>
    <span class="n">resultados_indicadores</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">seccion</span><span class="o">.</span><span class="n">codigo</span> <span class="p">:</span> <span class="n">indicador</span><span class="p">})</span>
</pre></div>
</div>
<p>Calculos totales en todos los indicadores de acuerdo al peso de los informantes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">aux_estudiante</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">aux_docente</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">aux_paracademico</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">aux_directivo</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">promedio_primaria</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">promedio_ponderada</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c"># Solo el codigo de la seccion</span>
<span class="k">for</span> <span class="n">seccion</span><span class="p">,</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_indicadores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">valores</span> <span class="o">=</span> <span class="n">resultado</span><span class="p">[</span><span class="s">&#39;informantes&#39;</span><span class="p">]</span>
    <span class="n">informantes</span> <span class="o">=</span> <span class="n">valores</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">informantes</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">primaria</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>Con un solo informante Comision Academica:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">informantes</span> <span class="o">==</span> <span class="p">[</span><span class="s">&#39;directivo&#39;</span><span class="p">,</span> <span class="s">&#39;paracademico&#39;</span><span class="p">]:</span>
    <span class="c"># (pdir * vdir) + (ppa * vpa)) / (pdir + ppa)</span>
    <span class="n">primaria</span> <span class="o">=</span> <span class="n">pesos</span><span class="p">[</span><span class="s">&#39;directivo&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">valores</span><span class="p">[</span><span class="s">&#39;directivo&#39;</span><span class="p">]</span> <span class="o">+</span>  <span class="n">pesos</span><span class="p">[</span><span class="s">&#39;paracademico&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">valores</span><span class="p">[</span><span class="s">&#39;paracademico&#39;</span><span class="p">]</span>
    <span class="n">primaria</span> <span class="o">=</span> <span class="n">primaria</span> <span class="o">/</span> <span class="p">(</span><span class="n">pesos</span><span class="p">[</span><span class="s">&#39;directivo&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pesos</span><span class="p">[</span><span class="s">&#39;paracademico&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Con dos informantes:</p>
<div class="highlight-python"><pre>elif informantes == ['directivo', 'docente', 'paracademico']:
    # ((mpne + pdir * vdir) + (mpne + ppa * vpa) + (??? + pd * cd))
    mitad = pesos['estudiante'] / 2
    primaria =  (mitad / 2 + pesos['directivo']) * valores['directivo']
    primaria += (mitad / 2 + pesos['paracademico']) * valores['paracademico']
    primaria += (mitad + pesos['docente']) * valores['docente']
elif informantes == ['directivo', 'estudiante', 'paracademico']:
    # ((mpne + pdir * vdir) + (mpne + ppa * vpa) + (??? + pd * cd))
    mitad = pesos['docente'] / 2
    primaria =  (mitad / 2 + pesos['directivo']) * valores['directivo']
    primaria += (mitad / 2 + pesos['paracademico']) * valores['paracademico']
    primaria += (mitad + pesos['estudiante']) * valores['estudiante']
elif informantes == ['docente', 'estudiante']:
    # (mpni + pe * ve) + (mpni + pd * vd)
    mitad = (pesos['directivo'] + pesos['paracademico']) / 2
    primaria = (mitad + pesos['estudiante']) * valores['estudiante']
    primaria += (mitad + pesos['docente']) * valores['docente']</pre>
</div>
<p>Con tres informantes:</p>
<div class="highlight-python"><pre>elif informantes == ['directivo', 'docente', 'estudiante', 'paracademico']:
    # (pe + ve) + ((pdir * vdir) + (ppa * vpa)) + (pd * vd))
    primaria = pesos['estudiante'] * valores['estudiante']
    primaria += pesos['docente'] * valores['docente']
    primaria += pesos['paracademico'] * valores['paracademico']
    primaria += pesos['directivo'] * valores['directivo']

primaria = round(primaria)
resultado.update({'primaria' : primaria})
promedio_primaria += primaria
ponderada = primaria * resultado['ponderacion_seccion'] / 100
promedio_ponderada += ponderada
resultado.update({'ponderada' : ponderada})
resultado.update({'cualitativa' : self._cualificar_valor(primaria)})
aux_estudiante.append(valores.get('estudiante', -1))
aux_directivo.append(valores.get('directivo', -1))
aux_docente.append(valores.get('docente', -1))
aux_paracademico.append(valores.get('paracademico', -1))</pre>
</div>
<p>En caso de que no se tata de un componente en particular:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span>  <span class="ow">not</span> <span class="n">componente</span><span class="p">:</span>
    <span class="c"># Se envia a calcular los promedios por cada componente</span>
    <span class="n">promedios_componentes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calcular_componentes</span><span class="p">(</span><span class="n">resultados_indicadores</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">promedios_componentes</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">aux_estudiante</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">aux_estudiante</span> <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">aux_docente</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">aux_docente</span> <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">aux_paracademico</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">aux_paracademico</span> <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">aux_directivo</span>  <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">aux_directivo</span> <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">prom_estudiante</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">aux_estudiante</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aux_estudiante</span><span class="p">)))</span> <span class="k">if</span> <span class="n">aux_estudiante</span> <span class="k">else</span> <span class="mi">0</span>
<span class="n">prom_docente</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">aux_docente</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aux_docente</span><span class="p">)))</span> <span class="k">if</span> <span class="n">aux_docente</span> <span class="k">else</span> <span class="mi">0</span>
<span class="n">prom_paracademico</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">aux_paracademico</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aux_paracademico</span><span class="p">)))</span> <span class="k">if</span> <span class="n">aux_paracademico</span> <span class="k">else</span> <span class="mi">0</span>
<span class="n">prom_directivo</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">aux_directivo</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aux_directivo</span><span class="p">)))</span> <span class="k">if</span> <span class="n">aux_directivo</span> <span class="k">else</span> <span class="mi">0</span>

<span class="n">promedio_primaria</span> <span class="o">=</span> <span class="p">(</span><span class="n">promedio_primaria</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados_indicadores</span><span class="p">))</span> <span class="k">if</span> <span class="n">resultados_indicadores</span> <span class="k">else</span> <span class="mi">0</span>

<span class="c"># Solo se suma la ponderacion hasta el final</span>

<span class="n">promedios</span><span class="o">=</span> <span class="p">{</span><span class="s">&#39;estudiante&#39;</span> <span class="p">:</span> <span class="n">prom_estudiante</span><span class="p">,</span>
            <span class="s">&#39;docente&#39;</span> <span class="p">:</span> <span class="n">prom_docente</span><span class="p">,</span>
            <span class="s">&#39;paracademico&#39;</span> <span class="p">:</span> <span class="n">prom_paracademico</span><span class="p">,</span>
            <span class="s">&#39;directivo&#39;</span> <span class="p">:</span> <span class="n">prom_directivo</span><span class="p">,</span>
            <span class="s">&#39;primaria&#39;</span> <span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">promedio_primaria</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
            <span class="s">&#39;ponderada&#39;</span> <span class="p">:</span> <span class="n">promedio_ponderada</span><span class="p">,</span>
            <span class="s">&#39;cualitativa&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cualificar_valor</span><span class="p">(</span><span class="n">promedio_primaria</span><span class="p">)</span>
            <span class="p">}</span>
<span class="c"># Se ordena el diccionario por la clave (codigo del indicador)</span>

<span class="n">resultados_indicadores</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">resultados_indicadores</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">logg</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Calculado docente: {0} promedios: {1} total: {2}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ids_docentes</span><span class="p">,</span> <span class="n">promedios</span><span class="p">,</span> <span class="n">promedio_ponderada</span><span class="p">))</span>
<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">resultados_indicadores</span><span class="o">=</span><span class="n">resultados_indicadores</span><span class="p">,</span> <span class="n">promedios_componentes</span><span class="o">=</span><span class="n">promedios_componentes</span><span class="p">,</span>
            <span class="n">promedios</span><span class="o">=</span><span class="n">promedios</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">promedio_ponderada</span><span class="p">,</span> <span class="n">seccion_componente</span><span class="o">=</span><span class="n">seccion_componente</span><span class="p">)</span>
</pre></div>
</div>
<p>Método para cálculo de componentes CPF, CPG Y PV:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_calcular_componentes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resultados_indicadores</span><span class="p">):</span>
    <span class="n">promedios_componentes</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;CPF&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s">&#39;estudiante&#39;</span><span class="p">:[],</span> <span class="s">&#39;docente&#39;</span><span class="p">:[],</span> <span class="s">&#39;paracademico&#39;</span><span class="p">:[],</span> <span class="s">&#39;directivo&#39;</span><span class="p">:[],</span>
                                      <span class="s">&#39;primaria&#39;</span> <span class="p">:</span> <span class="p">[],</span> <span class="s">&#39;ponderada&#39;</span><span class="p">:[],</span> <span class="s">&#39;cualitativa&#39;</span><span class="p">:</span><span class="s">&#39;&#39;</span><span class="p">},</span>
                             <span class="s">&#39;CPG&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s">&#39;estudiante&#39;</span><span class="p">:[],</span> <span class="s">&#39;docente&#39;</span><span class="p">:[],</span> <span class="s">&#39;paracademico&#39;</span><span class="p">:[],</span> <span class="s">&#39;directivo&#39;</span><span class="p">:[],</span>
                                      <span class="s">&#39;primaria&#39;</span> <span class="p">:</span> <span class="p">[],</span> <span class="s">&#39;ponderada&#39;</span><span class="p">:[],</span> <span class="s">&#39;cualitativa&#39;</span><span class="p">:</span><span class="s">&#39;&#39;</span><span class="p">},</span>
                             <span class="s">&#39;PV&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s">&#39;estudiante&#39;</span><span class="p">:[],</span> <span class="s">&#39;docente&#39;</span><span class="p">:[],</span> <span class="s">&#39;paracademico&#39;</span><span class="p">:[],</span> <span class="s">&#39;directivo&#39;</span><span class="p">:[],</span>
                                      <span class="s">&#39;primaria&#39;</span> <span class="p">:</span> <span class="p">[],</span> <span class="s">&#39;ponderada&#39;</span><span class="p">:[],</span> <span class="s">&#39;cualitativa&#39;</span><span class="p">:</span><span class="s">&#39;&#39;</span><span class="p">},</span>
                             <span class="p">}</span>
    <span class="k">for</span> <span class="n">codigo_seccion</span><span class="p">,</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_indicadores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">componente</span> <span class="o">=</span> <span class="n">resultado</span><span class="p">[</span><span class="s">&#39;objeto_seccion&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">superseccion</span><span class="o">.</span><span class="n">codigo</span>
        <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="s">&#39;estudiante&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resultado</span><span class="p">[</span><span class="s">&#39;informantes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;estudiante&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="s">&#39;docente&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resultado</span><span class="p">[</span><span class="s">&#39;informantes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;docente&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="s">&#39;paracademico&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resultado</span><span class="p">[</span><span class="s">&#39;informantes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;paracademico&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="s">&#39;directivo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resultado</span><span class="p">[</span><span class="s">&#39;informantes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;directivo&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="s">&#39;primaria&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resultado</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;primaria&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="s">&#39;ponderada&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resultado</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;ponderada&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">componente</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;CPF&#39;</span><span class="p">,</span> <span class="s">&#39;CPG&#39;</span><span class="p">,</span> <span class="s">&#39;PV&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">tipo_promedio</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;estudiante&#39;</span><span class="p">,</span> <span class="s">&#39;docente&#39;</span><span class="p">,</span> <span class="s">&#39;paracademico&#39;</span><span class="p">,</span> <span class="s">&#39;directivo&#39;</span><span class="p">,</span> <span class="s">&#39;primaria&#39;</span><span class="p">,</span> <span class="s">&#39;ponderada&#39;</span><span class="p">):</span>
            <span class="n">lista</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="n">tipo_promedio</span><span class="p">]</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tipo_promedio</span> <span class="o">==</span> <span class="s">&#39;ponderada&#39;</span><span class="p">:</span>
                <span class="n">promedio</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lista</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">promedio</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lista</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">)</span>

            <span class="c"># En este momento se cambia el contenido tipo lista por un numero</span>

            <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="n">tipo_promedio</span><span class="p">]</span> <span class="o">=</span> <span class="n">promedio</span>
        <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="s">&#39;cualitativa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cualificar_valor</span><span class="p">(</span>
            <span class="n">promedios_componentes</span><span class="p">[</span><span class="n">componente</span><span class="p">][</span><span class="s">&#39;primaria&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">promedios_componentes</span>
</pre></div>
</div>
<p>Se cualifica con valores enteros:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_cualificar_valor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valor</span><span class="p">):</span>
    <span class="n">rangos</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;IS&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">41</span><span class="p">),</span> <span class="s">&#39;PS&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span><span class="mi">61</span><span class="p">),</span> <span class="s">&#39;S&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">61</span><span class="p">,</span><span class="mi">81</span><span class="p">),</span> <span class="s">&#39;D&#39;</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">81</span><span class="p">,</span><span class="mi">101</span><span class="p">)}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">rangos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">round</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">k</span>
    <span class="k">return</span> <span class="s">&#39;&#39;</span>
</pre></div>
</div>
<p>Método para la obtener todas las sugerencias:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">extraer_sugerencias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">carrera</span><span class="p">,</span> <span class="n">ids_docentes</span><span class="p">):</span>
    <span class="n">sugerencias</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">area</span> <span class="o">==</span> <span class="s">&#39;ACE&#39;</span><span class="p">:</span>
        <span class="n">tipos</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;EstudianteIdiomas&#39;</span><span class="p">,</span> <span class="s">&#39;DocenteIdiomas&#39;</span><span class="p">,</span> <span class="s">&#39;ParAcademicoIdiomas&#39;</span><span class="p">,</span> <span class="s">&#39;DirectivoIdiomas&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tipos</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Estudiante&#39;</span><span class="p">,</span> <span class="s">&#39;Docente&#39;</span><span class="p">,</span> <span class="s">&#39;ParAcademico&#39;</span><span class="p">,</span> <span class="s">&#39;Directivo&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">id_docente</span> <span class="ow">in</span> <span class="n">ids_docentes</span><span class="p">:</span>
        <span class="n">resultado</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
<p>Solo nombres del docente:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nombre_docente</span> <span class="o">=</span> <span class="n">DocentePeriodoAcademico</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span><span class="o">.</span><span class="n">__unicode__</span><span class="p">()</span>
<span class="k">for</span> <span class="n">tipo</span> <span class="ow">in</span> <span class="n">tipos</span><span class="p">:</span>
    <span class="n">informante</span> <span class="o">=</span> <span class="n">tipo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;idiomas&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Codigo es PV, CPG o CPF:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">preguntas_ensayo</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">seccion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">,</span>
    <span class="n">seccion__cuestionario__informante__tipo</span><span class="o">=</span><span class="n">tipo</span><span class="p">,</span> <span class="n">tipo__tipo</span><span class="o">=</span><span class="s">&#39;Ensayo&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;seccion__codigo&#39;</span><span class="p">)</span>
<span class="n">resultado</span><span class="p">[</span><span class="n">tipo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>Contendra 3 items, uno por cada componente:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">aux_contestaciones</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">if</span> <span class="n">informante</span> <span class="o">==</span> <span class="s">&#39;estudiante&#39;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">pregunta</span> <span class="ow">in</span> <span class="n">preguntas_ensayo</span><span class="p">:</span>
        <span class="n">contestaciones</span> <span class="o">=</span> <span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">evaluacion__cuestionario__informante__tipo__icontains</span><span class="o">=</span><span class="s">&#39;estudiante&#39;</span><span class="p">,</span>
            <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">,</span>
            <span class="n">pregunta</span><span class="o">=</span><span class="n">pregunta</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">aux_contestaciones</span><span class="p">[</span><span class="n">pregunta</span><span class="p">[</span><span class="s">&#39;seccion__codigo&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">contestaciones</span>
<span class="k">elif</span> <span class="n">informante</span> <span class="o">==</span> <span class="s">&#39;docente&#39;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">pregunta</span> <span class="ow">in</span> <span class="n">preguntas_ensayo</span><span class="p">:</span>
        <span class="n">contestaciones</span> <span class="o">=</span> <span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">evaluacion__parAcademico__isnull</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">evaluacion__directorCarrera__isnull</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">evaluacion__docentePeriodoAcademico__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">,</span> <span class="n">pregunta</span><span class="o">=</span><span class="n">pregunta</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">aux_contestaciones</span><span class="p">[</span><span class="n">pregunta</span><span class="p">[</span><span class="s">&#39;seccion__codigo&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">contestaciones</span>
<span class="k">elif</span> <span class="n">informante</span> <span class="o">==</span> <span class="s">&#39;paracademico&#39;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">pregunta</span> <span class="ow">in</span> <span class="n">preguntas_ensayo</span><span class="p">:</span>
        <span class="n">contestaciones</span> <span class="o">=</span> <span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">evaluacion__parAcademico__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">evaluacion__directorCarrera__isnull</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">evaluacion__docentePeriodoAcademico__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">,</span> <span class="n">pregunta</span><span class="o">=</span><span class="n">pregunta</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">aux_contestaciones</span><span class="p">[</span><span class="n">pregunta</span><span class="p">[</span><span class="s">&#39;seccion__codigo&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">contestaciones</span>
<span class="k">elif</span> <span class="n">informante</span> <span class="o">==</span> <span class="s">&#39;directivo&#39;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">pregunta</span> <span class="ow">in</span> <span class="n">preguntas_ensayo</span><span class="p">:</span>
        <span class="n">contestaciones</span> <span class="o">=</span> <span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">evaluacion__directorCarrera__isnull</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">evaluacion__parAcademico__isnull</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">evaluacion__docentePeriodoAcademico__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">,</span> <span class="n">pregunta</span><span class="o">=</span><span class="n">pregunta</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">aux_contestaciones</span><span class="p">[</span><span class="n">pregunta</span><span class="p">[</span><span class="s">&#39;seccion__codigo&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">contestaciones</span>
</pre></div>
</div>
<p>Se supone que en los tres componentes hay la misma cantidad de respuestas CPF, CPG y PV:</p>
<div class="highlight-python"><pre>        num_contestaciones = len(aux_contestaciones.values()[0])
        for i in range(num_contestaciones):
            aux_dict = {'CPF' : aux_contestaciones['CPF'][i],
                        'CPG' : aux_contestaciones['CPG'][i],
                        'PV' : aux_contestaciones['PV'][i]}
            resultado[tipo].append(aux_dict)
    sugerencias[nombre_docente] = resultado
return dict(sugerencias=sugerencias)</pre>
</div>
</div>
<div class="section" id="clase-tabulacionadicionales2012">
<span id="class-tabulacionadicionales2012"></span><h2>Clase TabulacionAdicionales2012<a class="headerlink" href="#clase-tabulacionadicionales2012" title="Permalink to this headline">¶</a></h2>
<p>Tabulación de parámetros adicionales:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TabulacionAdicionales2012</span><span class="p">:</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="s">u&#39;EAAD2012&#39;</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="s">u&#39;Evaluación Actividades Adicionales a la Docencia 2012&#39;</span>
</pre></div>
</div>
<p>Constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periodoEvaluacion</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span> <span class="o">=</span> <span class="n">periodoEvaluacion</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">calculos</span> <span class="o">=</span> <span class="p">(</span>
        <span class="c"># codigo, descripcion, metodo, titulo</span>
        <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">u&#39;Resultados de la Evaluacion de Actividades Adicionales a la Docencia POR DOCENTE&#39;</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">por_docente</span><span class="p">,</span> <span class="s">u&#39;Evaluación Actividades Adicionales por Docente&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">u&#39;Resultados de la Evaluación de Actividades Adicionales a la Docencia POR CARRERA&#39;</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">por_carrera</span><span class="p">,</span> <span class="s">u&#39;Evaluación Actividades Adicionales por Carrera&#39;</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Método para obtener resultados de la Evaluación de Actividades Adicionales a la Docencia 2012 POR DOCENTE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">por_docente</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">id_docente</span><span class="p">):</span>
    <span class="n">docente</span> <span class="o">=</span> <span class="n">DocentePeriodoAcademico</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span>
</pre></div>
</div>
<p>Procesamiento de la Autoevaluacion del Docente:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>

    <span class="c"># Autoevaluacion de Actividades Adicionales del Docente</span>

    <span class="n">autoevaluacion</span><span class="o">=</span><span class="n">docente</span><span class="o">.</span><span class="n">evaluaciones</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cuestionario__periodoEvaluacion__id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                            <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">&#39;Docente&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">MultipleObjectsReturned</span><span class="p">:</span>

    <span class="c"># Existe una evaluacion duplicada</span>

    <span class="n">logg</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Autoevaluacion duplicada docente {0} en periodo:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">docente</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="c"># Se toma la primera evaluacion</span>

    <span class="n">autoevaluacion</span> <span class="o">=</span> <span class="n">docente</span><span class="o">.</span><span class="n">evaluaciones</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__periodoEvaluacion__id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                 <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">&#39;Docente&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">except</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
    <span class="n">logg</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">u&#39;No existe autoevaluación del docente {0} en periodo:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">docente</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">None</span>
</pre></div>
</div>
<p>Solo de selección única:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">contestaciones1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">autoevaluacion</span><span class="o">.</span><span class="n">contestaciones</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="k">if</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">pregunta</span><span class="p">)</span><span class="o">.</span><span class="n">tipo</span><span class="o">.</span><span class="n">id</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
<span class="n">total1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">respuesta</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contestaciones1</span><span class="p">])</span>
<span class="n">peso</span> <span class="o">=</span> <span class="p">(</span><span class="n">total1</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contestaciones1</span><span class="p">)))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contestaciones1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="k">else</span> <span class="mi">0</span>
<span class="n">porcentaje1</span> <span class="o">=</span> <span class="p">(</span><span class="n">peso</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p>Se coloca en Contestacion un objeto Pregunta en vez del id_pregunta entero:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contestaciones1</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">pregunta</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">pregunta</span><span class="p">)</span>
</pre></div>
</div>
<p>Procesamiento de la Evaluacion de la Comision Academica:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="c"># Evaluacion de Actividades Adicionales del Docente por parte de los Directivo</span>

    <span class="n">evaluacion</span><span class="o">=</span><span class="n">docente</span><span class="o">.</span><span class="n">evaluaciones</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cuestionario__periodoEvaluacion__id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                            <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">&#39;Directivo&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">MultipleObjectsReturned</span><span class="p">:</span>

    <span class="c"># Existe una evaluacion duplicada</span>

    <span class="n">logg</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Evaluacion duplicada docente {0} en periodo:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">docente</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="c"># Se toma la primera evaluacion</span>

    <span class="n">evaluacion</span> <span class="o">=</span> <span class="n">docente</span><span class="o">.</span><span class="n">evaluaciones</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__periodoEvaluacion__id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                 <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">&#39;Directivo&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">except</span> <span class="n">Evaluacion</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
    <span class="n">logg</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">u&#39;No existe evaluación de directivos para el docente {0} en periodo:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">docente</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">None</span>
</pre></div>
</div>
<p>Solo preguntas de seleccion única:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">contestaciones2</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">evaluacion</span><span class="o">.</span><span class="n">contestaciones</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="k">if</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">pregunta</span><span class="p">)</span><span class="o">.</span><span class="n">tipo</span><span class="o">.</span><span class="n">id</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
<span class="n">total2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">respuesta</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contestaciones2</span><span class="p">])</span>
<span class="n">peso</span> <span class="o">=</span> <span class="p">(</span><span class="n">total2</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contestaciones2</span><span class="p">)))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contestaciones2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
<span class="n">porcentaje2</span> <span class="o">=</span> <span class="p">(</span><span class="n">peso</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p>Se coloca en Contestacion un objeto Pregunta en vez del id_pregunta entero:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contestaciones2</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">pregunta</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">pregunta</span><span class="p">)</span>
</pre></div>
</div>
<p>Valor Total obtenido con  ponderacion: Comision Academica 80% - Docente 20%:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">total</span> <span class="o">=</span> <span class="p">(</span><span class="n">porcentaje1</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">porcentaje2</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">contestaciones</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">contestaciones</span><span class="p">[</span><span class="s">&#39;secciones&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">autoevaluacion</span><span class="o">.</span><span class="n">cuestionario</span><span class="o">.</span><span class="n">secciones</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
    <span class="n">seccion</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;titulo&#39;</span><span class="p">:</span><span class="n">s</span><span class="o">.</span><span class="n">titulo</span><span class="p">,</span> <span class="s">&#39;resultados&#39;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">preguntas</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">respuesta</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contestaciones1</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">pregunta</span><span class="o">.</span><span class="n">codigo</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">codigo</span><span class="p">]</span>
        <span class="n">valor_docente</span> <span class="o">=</span> <span class="n">l1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">l1</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">observaciones</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contestaciones1</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">pregunta</span><span class="o">.</span><span class="n">codigo</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">codigo</span><span class="p">]</span>
        <span class="n">observaciones_docente</span> <span class="o">=</span> <span class="n">l1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">l1</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">respuesta</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contestaciones2</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">pregunta</span><span class="o">.</span><span class="n">codigo</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">codigo</span><span class="p">]</span>
        <span class="n">valor_comision</span> <span class="o">=</span> <span class="n">l2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">l2</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">observaciones</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contestaciones2</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">pregunta</span><span class="o">.</span><span class="n">codigo</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">codigo</span><span class="p">]</span>
        <span class="n">observaciones_comision</span> <span class="o">=</span> <span class="n">l2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">l2</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
        <span class="n">porcentaje_docente</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">valor_docente</span><span class="p">)</span><span class="o">*</span><span class="mi">25</span> <span class="k">if</span> <span class="n">valor_docente</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
        <span class="n">porcentaje_comision</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">valor_comision</span><span class="p">)</span><span class="o">*</span><span class="mi">25</span> <span class="k">if</span> <span class="n">valor_comision</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">valor_docente</span> <span class="ow">or</span> <span class="n">valor_comision</span><span class="p">:</span>
            <span class="n">seccion</span><span class="p">[</span><span class="s">&#39;resultados&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;codigo&#39;</span><span class="p">:</span><span class="n">p</span><span class="o">.</span><span class="n">codigo</span><span class="p">,</span> <span class="s">&#39;texto&#39;</span><span class="p">:</span><span class="n">p</span><span class="o">.</span><span class="n">texto</span><span class="p">,</span>
                                          <span class="s">&#39;valor_comision&#39;</span><span class="p">:</span><span class="n">valor_comision</span><span class="p">,</span> <span class="s">&#39;valor_docente&#39;</span><span class="p">:</span><span class="n">valor_docente</span><span class="p">,</span>
                                          <span class="s">&#39;porcentaje_comision&#39;</span><span class="p">:</span><span class="n">porcentaje_comision</span><span class="p">,</span> <span class="s">&#39;porcentaje_docente&#39;</span><span class="p">:</span><span class="n">porcentaje_docente</span><span class="p">,</span>
                                          <span class="s">&#39;observaciones_comision&#39;</span><span class="p">:</span><span class="n">observaciones_comision</span><span class="p">,</span>
                                          <span class="s">&#39;observaciones_docente&#39;</span><span class="p">:</span><span class="n">observaciones_docente</span><span class="p">})</span>
    <span class="n">contestaciones</span><span class="p">[</span><span class="s">&#39;secciones&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seccion</span><span class="p">)</span>
<span class="n">num_actividades</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s">&#39;resultados&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">contestaciones</span><span class="p">[</span><span class="s">&#39;secciones&#39;</span><span class="p">]])</span>
<span class="n">contestaciones</span><span class="p">[</span><span class="s">&#39;num_actividades&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_actividades</span>
<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">contestaciones1</span><span class="o">=</span><span class="n">contestaciones1</span><span class="p">,</span> <span class="n">porcentaje1</span><span class="o">=</span><span class="n">porcentaje1</span><span class="p">,</span>
            <span class="n">contestaciones2</span><span class="o">=</span><span class="n">contestaciones2</span><span class="p">,</span> <span class="n">porcentaje2</span><span class="o">=</span><span class="n">porcentaje2</span><span class="p">,</span>
            <span class="n">contestaciones</span><span class="o">=</span><span class="n">contestaciones</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
<p>Resultados de la Evaluación de Actividades Adicionales a la Docencia 2012 POR CARRERA(incompleto):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">por_carrera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-tabulacionsatisfaccion2012">
<span id="class-tabulacionsatisfaccion2012"></span><h2>Clase TabulacionSatisfaccion2012<a class="headerlink" href="#clase-tabulacionsatisfaccion2012" title="Permalink to this headline">¶</a></h2>
<p>Tabulación de datos para la encuesta de satisfacción estudiantil año 2012:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TabulacionSatisfaccion2012</span><span class="p">:</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="s">u&#39;ESE2012&#39;</span>
    <span class="n">descripcion</span> <span class="o">=</span> <span class="s">u&#39;Encuesta de Satisfacción Estudiantil 2012&#39;</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periodoEvaluacion</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span> <span class="o">=</span> <span class="n">periodoEvaluacion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculos</span> <span class="o">=</span> <span class="p">(</span>
            <span class="c"># codigo, descripcion, metodo, titulo</span>
            <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">u&#39;La valoracion global de la Satisfacción Estudiantil por DOCENTE&#39;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">por_docente</span><span class="p">,</span> <span class="s">u&#39;Satisfacción Estudiantil por Docente&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">u&#39;La valoracion global de la Satisfacción Estudiantil por CARRERA&#39;</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">por_carrera</span><span class="p">,</span> <span class="s">u&#39;Satisfacción Estudiantil en la Carrera&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">u&#39;La valoracion  de la Satisfacción Estudiantil en cada uno de los CAMPOS, por carrera&#39;</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">por_campos</span><span class="p">,</span> <span class="s">u&#39;Satisfacción Estudiantil en Por Campos Específicos&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">u&#39;La valoración estudiantil en cada uno de los INDICADORES por carrera&#39;</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">por_indicador</span><span class="p">,</span> <span class="s">u&#39;Satisfacción Estudiantil por Indicador&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span><span class="s">u&#39;Los 10 indicadores de mayor SATISFACCIÓN en la Carrera&#39;</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">mayor_satisfaccion</span><span class="p">,</span> <span class="s">u&#39;Indicadores de Mayor Satisfacción&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span><span class="s">u&#39;Los 10 indicadores de mayor INSATISFACCIÓN en la Carrera&#39;</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">mayor_insatisfaccion</span><span class="p">,</span> <span class="s">u&#39;Indicadores de mayor Insatisfacción&#39;</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Método para obtener resultados de la encuesta, POR DOCENTE. Satisfacción Estudiantil de un docente en los  módulos, cursos, unidades o talleres:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">por_docente</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">id_docente</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">siglas_area</span> <span class="o">==</span> <span class="s">u&#39;ACE&#39;</span><span class="p">:</span>
        <span class="n">secciones</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">cuestionarios</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                           <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">u&#39;EstudianteIdiomas&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">secciones</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">cuestionarios</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                           <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">u&#39;Estudiante&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Para asegurar que se tomen unicamente preguntas que representen indicadores además. Se seleccionan solo ids para poder comparar:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">indicadores</span><span class="o">=</span><span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">seccion__in</span><span class="o">=</span><span class="n">secciones</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">tipo__tipo</span><span class="o">=</span><span class="s">u&#39;SeleccionUnica&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">conteo_ms</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>

    <span class="c"># Unica diferencia con respecto al metodo &#39;por_carrera&#39;</span>

    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>

    <span class="c"># Recordatorio: &#39;pregunta&#39; en Contestacion es int no de tipo Pregunta</span>

    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">MS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_s</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>

    <span class="c"># Unica diferencia con respecto al metodo &#39;por_carrera&#39;</span>

    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ps</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>

    <span class="c"># Unica diferencia con respecto al metodo &#39;por_carrera&#39;</span>

    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">PS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ins</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>

    <span class="c"># Unica diferencia con respecto al metodo &#39;por_carrera&#39;</span>

    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">INS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteos</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="p">:</span>
    <span class="n">conteo</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="c"># Se intercambia por el objeto completo, por versatilidad</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ins</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grado</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conteo</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">conteo</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">conteos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conteo</span><span class="p">)</span>
    <span class="n">totales</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="n">totales</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteos</span><span class="p">])</span>
    <span class="n">universo</span> <span class="o">=</span> <span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="c"># Unica diferencia con respecto al método &#39;por_carrera&#39;</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">totales</span><span class="p">[</span><span class="s">&#39;total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">universo</span>
    <span class="n">porcentajes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">universo</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">numero</span>  <span class="o">=</span> <span class="n">totales</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">universo</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numero</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">porcentajes</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="n">numero</span>
    <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;MSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;MS&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;S&#39;</span><span class="p">]</span>

<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conteos</span><span class="o">=</span><span class="n">conteos</span><span class="p">,</span> <span class="n">totales</span><span class="o">=</span><span class="n">totales</span><span class="p">,</span> <span class="n">porcentajes</span><span class="o">=</span><span class="n">porcentajes</span><span class="p">)</span>
</pre></div>
</div>
<p>Método para obtener Resultados de la encuesta, POR CARRERA. Todas las Secciones de todos los cuestionarios que pertenecen al periodo de evaluación establecido:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">por_carrera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">siglas_area</span> <span class="o">==</span> <span class="s">u&#39;ACE&#39;</span><span class="p">:</span>
        <span class="n">secciones</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">cuestionarios</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                           <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">u&#39;EstudianteIdiomas&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">secciones</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">cuestionarios</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                           <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">u&#39;Estudiante&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Para asegurar que se tomen unicamente preguntas que representen indicadores ademas, se seleccionan solo ids para poder comparar:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">indicadores</span><span class="o">=</span><span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">seccion__in</span><span class="o">=</span><span class="n">secciones</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">tipo__tipo</span><span class="o">=</span><span class="s">u&#39;SeleccionUnica&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">conteo_ms</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">MS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_s</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ps</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">PS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ins</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">INS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteos</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="p">:</span>
    <span class="n">conteo</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="c"># Se intercambia por el objeto completo por versatilidad</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ins</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grado</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conteo</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">conteo</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">conteos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conteo</span><span class="p">)</span>
    <span class="n">totales</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="n">totales</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteos</span><span class="p">])</span>
    <span class="n">universo</span> <span class="o">=</span> <span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">totales</span><span class="p">[</span><span class="s">&#39;total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">universo</span>
    <span class="n">porcentajes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">universo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">numero</span>  <span class="o">=</span> <span class="n">totales</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">universo</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numero</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">porcentajes</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="n">numero</span>
    <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;MSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;MS&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;S&#39;</span><span class="p">]</span>

<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conteos</span><span class="o">=</span><span class="n">conteos</span><span class="p">,</span> <span class="n">totales</span><span class="o">=</span><span class="n">totales</span><span class="p">,</span> <span class="n">porcentajes</span><span class="o">=</span><span class="n">porcentajes</span><span class="p">)</span>
</pre></div>
</div>
<p>Método para obtener información POR CAMPOS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">por_campos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">id_seccion</span><span class="p">):</span>

    <span class="c"># @param id_seccion representa el campo del cuestionario.</span>

    <span class="n">Seccion</span> <span class="o">=</span> <span class="n">Campo</span>
    <span class="k">if</span> <span class="n">id_seccion</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
</pre></div>
</div>
<p>La sección especcífica del cuestionario (por Área) que corresponde, ya se determina en la vista anterior:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">seccion</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">id_seccion</span><span class="p">)</span>
<span class="n">logg</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Campo Seccion: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">seccion</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">seccion</span><span class="p">))</span>

<span class="c"># Se tratan unicamente preguntas abiertas</span>

<span class="k">if</span> <span class="n">seccion</span><span class="o">.</span><span class="n">orden</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">por_otros_aspectos</span><span class="p">(</span><span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">seccion</span><span class="p">)</span>
</pre></div>
</div>
<p>Para asegurar que se tomen unicamente preguntas que representen indicadores además de que pertenezcan únicamente al campo (sección) especificado. Se seleccionan solo ids para poder comparar luego:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">indicadores</span><span class="o">=</span><span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">seccion</span><span class="o">=</span><span class="n">seccion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">tipo__tipo</span><span class="o">=</span><span class="s">u&#39;SeleccionUnica&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">conteo_ms</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">MS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_s</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ps</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">PS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ins</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">INS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteos</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="p">:</span>
    <span class="n">conteo</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="c"># Se intercambia por el objeto completo por versatilidad</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ins</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grado</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conteo</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">conteo</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">conteos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conteo</span><span class="p">)</span>
    <span class="n">totales</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="n">totales</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteos</span><span class="p">])</span>
    <span class="n">universo</span> <span class="o">=</span> <span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">totales</span><span class="p">[</span><span class="s">&#39;total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">universo</span>
    <span class="n">porcentajes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">universo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">numero</span>  <span class="o">=</span> <span class="n">totales</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">universo</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numero</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">porcentajes</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="n">numero</span>
    <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;MSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;MS&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;S&#39;</span><span class="p">]</span>

<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conteos</span><span class="o">=</span><span class="n">conteos</span><span class="p">,</span> <span class="n">totales</span><span class="o">=</span><span class="n">totales</span><span class="p">,</span> <span class="n">porcentajes</span><span class="o">=</span><span class="n">porcentajes</span><span class="p">)</span>
</pre></div>
</div>
<p>Método para obtener información POR OTROS ASPECTOS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">por_otros_aspectos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">seccion</span><span class="p">):</span>
    <span class="n">indicadores</span><span class="o">=</span><span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">seccion</span><span class="o">=</span><span class="n">seccion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">tipo__tipo</span><span class="o">=</span><span class="s">u&#39;Ensayo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">conteo</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">,</span><span class="s">&#39;respuesta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="n">frecuencia</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Para acceder a los datos del objeto pregunta en el template:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo</span><span class="p">:</span>
    <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">])</span>
<span class="k">return</span> <span class="n">conteo</span>
</pre></div>
</div>
<p>Método para obtener información POR INDICADOR:</p>
<div class="highlight-python"><pre>def por_indicador(self,siglas_area, nombre_carrera, id_pregunta ):</pre>
</div>
<p>El id_pregunta representa el indicador del campo del cuestionario. Pregunta = Indicador.</p>
<p>La pregunta específica del cuestionario (por Área) que corresponde ya se determina en la vista anterior, se selecciona unicamente el id para la comparación posterior:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">indicadores</span> <span class="o">=</span> <span class="p">(</span><span class="n">id_pregunta</span><span class="p">,</span> <span class="p">)</span>
<span class="n">conteo_ms</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">MS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_s</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ps</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">PS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ins</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">INS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteos</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="p">:</span>
    <span class="n">conteo</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="c"># Se intercambia por el objeto completo por versatilidad</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ins</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grado</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conteo</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">conteo</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">conteos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conteo</span><span class="p">)</span>
    <span class="n">totales</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="n">totales</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteos</span><span class="p">])</span>
    <span class="n">universo</span> <span class="o">=</span> <span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">totales</span><span class="p">[</span><span class="s">&#39;total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">universo</span>
    <span class="n">porcentajes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">universo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">numero</span> <span class="o">=</span> <span class="n">totales</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">universo</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numero</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">porcentajes</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="n">numero</span>
    <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;MSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;MS&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">porcentajes</span><span class="p">[</span><span class="s">&#39;S&#39;</span><span class="p">]</span>

<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conteos</span><span class="o">=</span><span class="n">conteos</span><span class="p">,</span> <span class="n">totales</span><span class="o">=</span><span class="n">totales</span><span class="p">,</span> <span class="n">porcentajes</span><span class="o">=</span><span class="n">porcentajes</span><span class="p">)</span>
</pre></div>
</div>
<p>Parámetros que generan mayor satisfacción. Contiene todas las Secciones de todos los cuestionarios que pertenecen al periodo de evaluación establecido:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">mayor_satisfaccion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">siglas_area</span> <span class="o">==</span> <span class="s">u&#39;ACE&#39;</span><span class="p">:</span>
        <span class="n">secciones</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">cuestionarios</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                           <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">u&#39;EstudianteIdiomas&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">secciones</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">cuestionarios</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                           <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">u&#39;Estudiante&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>La siguiente sección de codigo tiene la finalidad de asegurar que se tomen unicamente preguntas que representen indicadores, además se seleccionan solo ids para poder comparar:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">indicadores</span><span class="o">=</span><span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">seccion__in</span><span class="o">=</span><span class="n">secciones</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">tipo__tipo</span><span class="o">=</span><span class="s">u&#39;SeleccionUnica&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">conteo_ms</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">MS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_s</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ps</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">PS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteo_ins</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">INS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
<span class="n">conteos</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>Se realiza el conteo por cada pregunta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="p">:</span>
    <span class="n">conteo</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="c"># Se intercambia por el objeto completo por versatilidad</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ins</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grado</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conteo</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">conteo</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">conteos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conteo</span><span class="p">)</span>
</pre></div>
</div>
<p>Se ordena de mayor a menor por &#8216;MS&#8217; luego por &#8216;S&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">conteos</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">:</span> <span class="o">-</span><span class="nb">cmp</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="s">&#39;MS&#39;</span><span class="p">],</span><span class="n">c2</span><span class="p">[</span><span class="s">&#39;MS&#39;</span><span class="p">])</span> <span class="ow">or</span> <span class="o">-</span><span class="nb">cmp</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="s">&#39;S&#39;</span><span class="p">],</span><span class="n">c2</span><span class="p">[</span><span class="s">&#39;S&#39;</span><span class="p">]</span> <span class="p">))</span>
<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conteos</span><span class="o">=</span><span class="n">conteos</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">totales</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">porcentajes</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Método que contiene parámetros que producen mayor insatisfacción. Contiene todas las Secciones de todos los cuestionarios que pertenecen al periodo de evaluación establecido:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">mayor_insatisfaccion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">siglas_area</span> <span class="o">==</span> <span class="s">u&#39;ACE&#39;</span><span class="p">:</span>
        <span class="n">secciones</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">cuestionarios</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                           <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">u&#39;EstudianteIdiomas&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">secciones</span> <span class="o">=</span> <span class="n">Seccion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cuestionario__in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="o">.</span><span class="n">cuestionarios</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span>
                                           <span class="n">cuestionario__informante__tipo</span><span class="o">=</span><span class="s">u&#39;Estudiante&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Sección de código para asegurar que se tomen unicamente preguntas que representen indicadores además, se seleccionan solo ids para poder comparar:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">indicadores</span><span class="o">=</span><span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">seccion__in</span><span class="o">=</span><span class="n">secciones</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">tipo__tipo</span><span class="o">=</span><span class="s">u&#39;SeleccionUnica&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">conteos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contabilizar</span><span class="p">(</span><span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">indicadores</span><span class="p">)</span>
</pre></div>
</div>
<p>A continuación se ordena de mayor a menor por &#8216;INS&#8217; luego por &#8216;PS&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">conteos</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">:</span> <span class="o">-</span><span class="nb">cmp</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="s">&#39;INS&#39;</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="s">&#39;INS&#39;</span><span class="p">])</span> <span class="ow">or</span> <span class="o">-</span><span class="nb">cmp</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="s">&#39;PS&#39;</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="s">&#39;PS&#39;</span><span class="p">]</span> <span class="p">))</span>
<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conteos</span><span class="o">=</span><span class="n">conteos</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">totales</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">porcentajes</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>El parámetro <cite>indicadores</cite>: lista de ids de pregunta que se involucran en el conteo.
El parámetro <cite>id_docente</cite>: para el caso único en el que no se contabiliza en toda la carrera:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_contabilizar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">siglas_area</span><span class="p">,</span> <span class="n">nombre_carrera</span><span class="p">,</span> <span class="n">indicadores</span><span class="o">=</span><span class="p">[],</span> <span class="n">id_docente</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">conteo_ms</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">MS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
    <span class="n">conteo_s</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
    <span class="n">conteo_ps</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">PS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
    <span class="n">conteo_ins</span><span class="o">=</span><span class="n">Contestacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__cuestionario__periodoEvaluacion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">periodoEvaluacion</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__cuestionario__periodoEvaluacion__tabulacion__tipo</span><span class="o">=</span><span class="s">&#39;ESE2012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__area</span><span class="o">=</span><span class="n">siglas_area</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__asignatura__carrera</span><span class="o">=</span><span class="n">nombre_carrera</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pregunta__in</span><span class="o">=</span><span class="n">indicadores</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">INS</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;respuesta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">respuesta</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pregunta&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">id_docente</span><span class="p">:</span>
        <span class="n">conteo_ms</span> <span class="o">=</span> <span class="n">conteo_ms</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span>
        <span class="n">conteo_s</span> <span class="o">=</span> <span class="n">conteo_s</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span>
        <span class="n">conteo_ps</span> <span class="o">=</span> <span class="n">conteo_ps</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span>
        <span class="n">conteo_ins</span> <span class="o">=</span> <span class="n">conteo_ins</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">evaluacion__estudianteAsignaturaDocente__asignaturaDocente__docente__id</span><span class="o">=</span><span class="n">id_docente</span><span class="p">)</span>
    <span class="n">conteos</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>Se realiza el conteo por cada pregunta:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indicadores</span><span class="p">:</span>
    <span class="n">conteo</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="c"># Se intercambia por el objeto completo por versatilidad</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">conteo_ins</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">conteo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">conteo</span><span class="p">[</span><span class="s">&#39;pregunta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pregunta</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">grado</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;MS&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="s">&#39;PS&#39;</span><span class="p">,</span><span class="s">&#39;INS&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grado</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conteo</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">conteo</span><span class="p">[</span><span class="n">grado</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">conteos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conteo</span><span class="p">)</span>
<span class="k">return</span> <span class="n">conteos</span>
</pre></div>
</div>
</div>
<div class="section" id="clase-usuario">
<span id="class-usuario"></span><h2>Clase Usuario<a class="headerlink" href="#clase-usuario" title="Permalink to this headline">¶</a></h2>
<p>Clase principal. Contiene los atributos y metodos generales para los usuarios del sistema y administradores.
Se crea el perfil de Usuario que podrá pertener a los grupos Estudiante y/o Docente:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Usuario</span><span class="p">(</span><span class="n">User</span><span class="p">):</span>
    <span class="n">cedula</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;15&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">titulo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="s">&#39;100&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_nombres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_name</span>

    <span class="k">def</span> <span class="nf">set_nombres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nombres</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_name</span> <span class="o">=</span> <span class="n">nombres</span>

    <span class="k">def</span> <span class="nf">get_apellidos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_name</span>

    <span class="k">def</span> <span class="nf">set_apellidos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apellidos</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_name</span> <span class="o">=</span> <span class="n">apellidos</span>
</pre></div>
</div>
<p>Abreviaturas para los distintos tipos de Títulos y sus equivalencias:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_abreviatura</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">equivalencias</span> <span class="o">=</span> <span class="p">{</span><span class="s">u&#39;magister&#39;</span><span class="p">:</span><span class="s">u&#39;Mg.&#39;</span><span class="p">,</span> <span class="s">u&#39;magíster&#39;</span><span class="p">:</span><span class="s">u&#39;Mg.&#39;</span><span class="p">,</span> <span class="s">u&#39;ing.&#39;</span><span class="p">:</span><span class="s">u&#39;Ing.&#39;</span><span class="p">,</span> <span class="s">u&#39;ingeniero&#39;</span><span class="p">:</span><span class="s">u&#39;Ing.&#39;</span><span class="p">,</span> <span class="s">u&#39;ingeniera&#39;</span><span class="p">:</span><span class="s">u&#39;Ing.&#39;</span><span class="p">,</span>
                     <span class="s">u&#39;Ing.&#39;</span><span class="p">:</span><span class="s">u&#39;Ing.&#39;</span><span class="p">,</span> <span class="s">u&#39;doctor&#39;</span><span class="p">:</span><span class="s">u&#39;Dr.&#39;</span><span class="p">,</span> <span class="s">u&#39;doctora&#39;</span><span class="p">:</span><span class="s">u&#39;Dra.&#39;</span><span class="p">,</span> <span class="s">u&#39;master&#39;</span><span class="p">:</span><span class="s">u&#39;Ms.&#39;</span><span class="p">,</span>
                     <span class="s">u&#39;mg.&#39;</span><span class="p">:</span><span class="s">u&#39;Mg.&#39;</span><span class="p">,</span> <span class="s">u&#39;licenciado&#39;</span><span class="p">:</span><span class="s">u&#39;Lic.&#39;</span><span class="p">,</span> <span class="s">u&#39;licenciada&#39;</span><span class="p">:</span><span class="s">u&#39;Lic.&#39;</span><span class="p">,</span> <span class="s">u&#39;economista&#39;</span><span class="p">:</span><span class="s">u&#39;Eco.&#39;</span><span class="p">,</span> <span class="s">u&#39;eco.&#39;</span><span class="p">:</span><span class="s">u&#39;Eco.&#39;</span><span class="p">,</span> <span class="s">u&#39;medico&#39;</span><span class="p">:</span><span class="s">u&#39;Dr.&#39;</span><span class="p">,</span>
                     <span class="s">u&#39;dra.&#39;</span><span class="p">:</span><span class="s">u&#39;Dra.&#39;</span><span class="p">,</span><span class="s">u&#39;dr.&#39;</span><span class="p">:</span><span class="s">u&#39;Dr.&#39;</span><span class="p">,</span><span class="s">u&#39;lic.&#39;</span><span class="p">:</span><span class="s">u&#39;Lic.&#39;</span><span class="p">,</span> <span class="s">u&#39;licdo.&#39;</span><span class="p">:</span><span class="s">u&#39;Lic.&#39;</span><span class="p">,</span><span class="s">u&#39;ing.&#39;</span><span class="p">:</span><span class="s">u&#39;Ing.&#39;</span><span class="p">,</span> <span class="s">u&#39;phd.&#39;</span><span class="p">:</span><span class="s">u&#39;Phd.&#39;</span><span class="p">,</span><span class="s">u&#39;médico&#39;</span><span class="p">:</span><span class="s">u&#39;Dr.&#39;</span><span class="p">,</span>
                     <span class="s">u&#39;odontólogo&#39;</span><span class="p">:</span> <span class="s">u&#39;Odont.&#39;</span><span class="p">,</span> <span class="s">u&#39;odontóloga&#39;</span><span class="p">:</span> <span class="s">u&#39;Odont.&#39;</span><span class="p">,</span> <span class="s">u&#39;odontologo&#39;</span><span class="p">:</span> <span class="s">u&#39;Odont.&#39;</span><span class="p">,</span> <span class="s">u&#39;odontologa&#39;</span><span class="p">:</span> <span class="s">u&#39;Odont.&#39;</span><span class="p">,</span>
                     <span class="s">u&#39;esp.&#39;</span><span class="p">:</span><span class="s">u&#39;Esp.&#39;</span><span class="p">,</span> <span class="s">u&#39;Especialista&#39;</span><span class="p">:</span><span class="s">u&#39;Esp.&#39;</span>
                     <span class="p">}</span>
    <span class="n">palabras</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">titulo</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">titulo</span> <span class="k">else</span> <span class="s">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palabras</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">equivalencias</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">equivalencias</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span>
</pre></div>
</div>
<p>Demás atributos que distinguen al usuario:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nombres</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_nombres</span><span class="p">,</span> <span class="n">set_nombres</span><span class="p">)</span>
<span class="n">apellidos</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_apellidos</span><span class="p">,</span> <span class="n">set_apellidos</span><span class="p">)</span>
<span class="n">abreviatura</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_abreviatura</span><span class="p">)</span>
</pre></div>
</div>
<p>Presentación mediante cédula y nombre completo:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">u&#39;{0} {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cedula</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">());</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Regresar a la cabecera</a>
      
    </p>
    <p>
        &copy; Copyright 2013, Jhymer Martínez.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2b2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>